{
  "hash": "02e8026c465b4045b2b51823b5eb4107",
  "result": {
    "engine": "knitr",
    "markdown": "---\nformat: html\n---\n\n\n# Welcome {.unnumbered}\n\n\n<!-- README.md is generated from README.Rmd. Please edit that file -->\n\nThis book provides examples of exposure-response analysis with Bayesian\nmethods.\n\n## Install necessary packages <a href=\"https://genentech.github.io/BayesERtools/\"><img src=\"resources/BayesERtool-logo.png\" align=\"right\" height=\"138\" alt=\"BayesERtools website\" /></a>\n\nThe examples utilizes\n[`BayesERtools`](https://genentech.github.io/BayesERtools/) package.\n\n- Tutorial (`BayesERbook`): <https://genentech.github.io/BayesERbook/>\n- Package documentation: <https://genentech.github.io/BayesERtools/>\n- GitHub repo of the package:\n  <https://github.com/genentech/BayesERtools/>\n\nYou can install the package as follows:\n\n``` r\ninstall.packages('BayesERtools')\n# devtools::install_github(\"genentech/BayesERtools\") # development version\n```\n\n## Quick Example\n\n``` r\nlibrary(BayesERtools)\nlibrary(dplyr)\nggplot2::theme_set(ggplot2::theme_bw(base_size = 12))\n\n# Data\ndata(d_sim_binom_cov)\ndf_er_ae_hgly2 <- \n  d_sim_binom_cov |> \n  mutate(AUCss_1000 = AUCss / 1000) |> \n  filter(AETYPE == \"hgly2\")\n\n# Fit a model\nermod <- dev_ermod_bin(\n  data = df_er_ae_hgly2,\n  var_resp = \"AEFLAG\",\n  var_exposure = \"AUCss_1000\"\n)\n\n# Goodness-of-fit plot\nplot_er_gof(ermod, var_group = \"Dose_mg\", show_coef_exp = TRUE) *\n  xgxr::xgx_scale_x_log10(guide = ggplot2::guide_axis(minor.ticks = TRUE))\n```\n\n<img src=\"man/figures/README-quick-ex-1.png\" width=\"75%\" />\n\n## Model types supported by `BayesERtools`\n\n<div id=\"pzveloiefp\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n  &#10;  <table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings gt_spanner_row\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"2\" colspan=\"1\" style=\"text-align: center; vertical-align: top;\" scope=\"col\" id=\"feature_name\"></th>\n      <th class=\"gt_center gt_columns_top_border gt_column_spanner_outer\" rowspan=\"1\" colspan=\"2\" scope=\"colgroup\" id=\"Binary endpoint\">\n        <div class=\"gt_column_spanner\">Binary endpoint</div>\n      </th>\n      <th class=\"gt_center gt_columns_top_border gt_column_spanner_outer\" rowspan=\"1\" colspan=\"2\" scope=\"colgroup\" id=\"Continuous endpoint\">\n        <div class=\"gt_column_spanner\">Continuous endpoint</div>\n      </th>\n    </tr>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" style=\"text-align: center; vertical-align: top;\" scope=\"col\" id=\"lin_logit\">Linear (logit)</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" style=\"text-align: center; vertical-align: top;\" scope=\"col\" id=\"emax_logit\"><span class='gt_from_md'>E<sub/>max</sub> (logit)</span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" style=\"text-align: center; vertical-align: top;\" scope=\"col\" id=\"linear\">Linear</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" style=\"text-align: center; vertical-align: top;\" scope=\"col\" id=\"emax\"><span class='gt_from_md'>E<sub/>max</sub></span></th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"feature_name\" class=\"gt_row gt_left\" style=\"text-align: right; vertical-align: middle;\"><span class='gt_from_md'>backend</span></td>\n<td headers=\"lin_logit\" class=\"gt_row gt_left\" style=\"text-align: center; vertical-align: middle;\"><span class='gt_from_md'><code>rstanarm</code></span></td>\n<td headers=\"emax_logit\" class=\"gt_row gt_left\" style=\"text-align: center; vertical-align: middle;\"><span class='gt_from_md'><code>rstanemax</code></span></td>\n<td headers=\"linear\" class=\"gt_row gt_left\" style=\"text-align: center; vertical-align: middle;\"><span class='gt_from_md'><code>rstanarm</code></span></td>\n<td headers=\"emax\" class=\"gt_row gt_left\" style=\"text-align: center; vertical-align: middle;\"><span class='gt_from_md'><code>rstanemax</code></span></td></tr>\n    <tr><td headers=\"feature_name\" class=\"gt_row gt_left\" style=\"text-align: right; vertical-align: middle;\"><span class='gt_from_md'>reference</span></td>\n<td headers=\"lin_logit\" class=\"gt_row gt_left\" style=\"text-align: center; vertical-align: middle;\"><span style=\"white-space: pre;\"><a href=\"https://mc-stan.org/rstanarm/reference/stan_glm.html\" target=\"_blank\" style=\"color:#008B8B;text-decoration:none;display: inline-block;\">🔗</a></span></td>\n<td headers=\"emax_logit\" class=\"gt_row gt_left\" style=\"text-align: center; vertical-align: middle;\"><span style=\"white-space: pre;\"><a href=\"https://yoshidk6.github.io/rstanemax/reference/stan_emax.html\" target=\"_blank\" style=\"color:#008B8B;text-decoration:none;display: inline-block;\">🔗</a></span></td>\n<td headers=\"linear\" class=\"gt_row gt_left\" style=\"text-align: center; vertical-align: middle;\"><span style=\"white-space: pre;\"><a href=\"https://mc-stan.org/rstanarm/reference/stan_glm.html\" target=\"_blank\" style=\"color:#008B8B;text-decoration:none;display: inline-block;\">🔗</a></span></td>\n<td headers=\"emax\" class=\"gt_row gt_left\" style=\"text-align: center; vertical-align: middle;\"><span style=\"white-space: pre;\"><a href=\"https://yoshidk6.github.io/rstanemax/reference/stan_emax_binary.html\" target=\"_blank\" style=\"color:#008B8B;text-decoration:none;display: inline-block;\">🔗</a></span></td></tr>\n    <tr><td headers=\"feature_name\" class=\"gt_row gt_left\" style=\"text-align: right; vertical-align: middle;\"><span class='gt_from_md'>develop model</span></td>\n<td headers=\"lin_logit\" class=\"gt_row gt_left\" style=\"text-align: center; vertical-align: middle;\"><span class='gt_from_md'>✅</span></td>\n<td headers=\"emax_logit\" class=\"gt_row gt_left\" style=\"text-align: center; vertical-align: middle;\"><span class='gt_from_md'>✅</span></td>\n<td headers=\"linear\" class=\"gt_row gt_left\" style=\"text-align: center; vertical-align: middle;\"><span class='gt_from_md'>✅</span></td>\n<td headers=\"emax\" class=\"gt_row gt_left\" style=\"text-align: center; vertical-align: middle;\"><span class='gt_from_md'>✅</span></td></tr>\n    <tr><td headers=\"feature_name\" class=\"gt_row gt_left\" style=\"text-align: right; vertical-align: middle;\"><span class='gt_from_md'>simulate &amp; plot ER</span></td>\n<td headers=\"lin_logit\" class=\"gt_row gt_left\" style=\"text-align: center; vertical-align: middle;\"><span class='gt_from_md'>✅</span></td>\n<td headers=\"emax_logit\" class=\"gt_row gt_left\" style=\"text-align: center; vertical-align: middle;\"><span class='gt_from_md'>✅</span></td>\n<td headers=\"linear\" class=\"gt_row gt_left\" style=\"text-align: center; vertical-align: middle;\"><span class='gt_from_md'>✅</span></td>\n<td headers=\"emax\" class=\"gt_row gt_left\" style=\"text-align: center; vertical-align: middle;\"><span class='gt_from_md'>✅</span></td></tr>\n    <tr><td headers=\"feature_name\" class=\"gt_row gt_left\" style=\"text-align: right; vertical-align: middle;\"><span class='gt_from_md'>exposure metrics selection</span></td>\n<td headers=\"lin_logit\" class=\"gt_row gt_left\" style=\"text-align: center; vertical-align: middle;\"><span class='gt_from_md'>✅</span></td>\n<td headers=\"emax_logit\" class=\"gt_row gt_left\" style=\"text-align: center; vertical-align: middle;\"><span class='gt_from_md'>✅</span></td>\n<td headers=\"linear\" class=\"gt_row gt_left\" style=\"text-align: center; vertical-align: middle;\"><span class='gt_from_md'>✅</span></td>\n<td headers=\"emax\" class=\"gt_row gt_left\" style=\"text-align: center; vertical-align: middle;\"><span class='gt_from_md'>✅</span></td></tr>\n    <tr><td headers=\"feature_name\" class=\"gt_row gt_left\" style=\"text-align: right; vertical-align: middle;\"><span class='gt_from_md'>covariate selection</span></td>\n<td headers=\"lin_logit\" class=\"gt_row gt_left\" style=\"text-align: center; vertical-align: middle;\"><span class='gt_from_md'>✅</span></td>\n<td headers=\"emax_logit\" class=\"gt_row gt_left\" style=\"text-align: center; vertical-align: middle;\"><span class='gt_from_md'>❌</span></td>\n<td headers=\"linear\" class=\"gt_row gt_left\" style=\"text-align: center; vertical-align: middle;\"><span class='gt_from_md'>✅</span></td>\n<td headers=\"emax\" class=\"gt_row gt_left\" style=\"text-align: center; vertical-align: middle;\"><span class='gt_from_md'>❌</span></td></tr>\n    <tr><td headers=\"feature_name\" class=\"gt_row gt_left\" style=\"text-align: right; vertical-align: middle;\"><span class='gt_from_md'>covariate forest plot</span></td>\n<td headers=\"lin_logit\" class=\"gt_row gt_left\" style=\"text-align: center; vertical-align: middle;\"><span class='gt_from_md'>✅</span></td>\n<td headers=\"emax_logit\" class=\"gt_row gt_left\" style=\"text-align: center; vertical-align: middle;\"><span class='gt_from_md'>❌</span></td>\n<td headers=\"linear\" class=\"gt_row gt_left\" style=\"text-align: center; vertical-align: middle;\"><span class='gt_from_md'>🟡</span></td>\n<td headers=\"emax\" class=\"gt_row gt_left\" style=\"text-align: center; vertical-align: middle;\"><span class='gt_from_md'>❌</span></td></tr>\n  </tbody>\n  &#10;  <tfoot class=\"gt_footnotes\">\n    <tr>\n      <td class=\"gt_footnote\" colspan=\"5\"> ✅ Available, 🟡 In plan/under development, ❌ Not in a current plan</td>\n    </tr>\n  </tfoot>\n</table>\n</div>\n\n## Note for developer\n\nRun `usethis::use_tidy_style(strict = FALSE)` before committing to\nensure that the code is formatted appropriately.\n\n\n\n\n## Session info\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndevtools::session_info()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.3.3 (2024-02-29)\n os       macOS Sonoma 14.7.6\n system   aarch64, darwin20\n ui       X11\n language (EN)\n collate  en_US.UTF-8\n ctype    en_US.UTF-8\n tz       Europe/Zurich\n date     2025-06-17\n pandoc   3.4 @ /Applications/RStudio.app/Contents/Resources/app/quarto/bin/tools/aarch64/ (via rmarkdown)\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package        * version    date (UTC) lib source\n abind            1.4-8      2024-09-12 [1] CRAN (R 4.3.3)\n arrayhelpers     1.1-0      2020-02-04 [1] CRAN (R 4.3.0)\n backports        1.5.0      2024-05-23 [1] CRAN (R 4.3.3)\n base64enc        0.1-3      2015-07-28 [1] RSPM (R 4.3.0)\n BayesERtools   * 0.2.2      2025-06-06 [1] CRAN (R 4.3.3)\n bayesplot      * 1.11.1     2024-02-15 [1] CRAN (R 4.3.1)\n boot             1.3-28.1   2022-11-22 [1] RSPM (R 4.3.0)\n cachem           1.1.0      2024-05-16 [1] CRAN (R 4.3.3)\n checkmate        2.3.2      2024-07-29 [1] CRAN (R 4.3.3)\n cli              3.6.4      2025-02-13 [1] CRAN (R 4.3.3)\n coda             0.19-4.1   2024-01-31 [1] CRAN (R 4.3.1)\n codetools        0.2-19     2023-02-01 [1] CRAN (R 4.3.3)\n colorspace       2.1-1      2024-07-26 [1] CRAN (R 4.3.3)\n colourpicker     1.3.0      2023-08-21 [1] CRAN (R 4.3.0)\n crosstalk        1.2.1      2023-11-23 [1] RSPM (R 4.3.0)\n curl             5.2.0      2023-12-08 [1] RSPM (R 4.3.0)\n devtools         2.4.5      2022-10-11 [1] CRAN (R 4.3.0)\n digest           0.6.37     2024-08-19 [1] CRAN (R 4.3.3)\n distributional   0.5.0      2024-09-17 [1] CRAN (R 4.3.3)\n dplyr          * 1.1.4      2023-11-17 [1] CRAN (R 4.3.1)\n DT               0.31       2023-12-09 [1] RSPM (R 4.3.0)\n dygraphs         1.1.1.6    2018-07-11 [1] CRAN (R 4.3.0)\n ellipsis         0.3.2      2021-04-29 [1] RSPM (R 4.3.0)\n evaluate         0.24.0     2024-06-10 [1] CRAN (R 4.3.3)\n farver           2.1.2      2024-05-13 [1] CRAN (R 4.3.3)\n fastmap          1.2.0      2024-05-15 [1] CRAN (R 4.3.3)\n forcats        * 1.0.0      2023-01-29 [1] RSPM (R 4.3.0)\n fs               1.6.5      2024-10-30 [1] CRAN (R 4.3.3)\n generics         0.1.3      2022-07-05 [1] RSPM (R 4.3.0)\n ggdist           3.3.2      2024-03-05 [1] CRAN (R 4.3.1)\n ggplot2        * 3.5.2.9001 2025-06-16 [1] Github (tidyverse/ggplot2@a2d0181)\n glue             1.8.0      2024-09-30 [1] CRAN (R 4.3.3)\n gridExtra        2.3        2017-09-09 [1] CRAN (R 4.3.0)\n gt             * 1.0.0      2025-04-05 [1] CRAN (R 4.3.3)\n gtable           0.3.6      2024-10-25 [1] CRAN (R 4.3.3)\n gtools           3.9.5      2023-11-20 [1] CRAN (R 4.3.1)\n here           * 1.0.1      2020-12-13 [1] RSPM (R 4.3.0)\n hms              1.1.3      2023-03-21 [1] RSPM (R 4.3.0)\n htmltools        0.5.8.1    2024-04-04 [1] CRAN (R 4.3.1)\n htmlwidgets      1.6.4      2023-12-06 [1] RSPM (R 4.3.0)\n httpuv           1.6.15     2024-03-26 [1] CRAN (R 4.3.1)\n igraph           2.0.3      2024-03-13 [1] CRAN (R 4.3.1)\n inline           0.3.19     2021-05-31 [1] CRAN (R 4.3.0)\n jsonlite         1.9.0      2025-02-19 [1] CRAN (R 4.3.3)\n knitr            1.48       2024-07-07 [1] CRAN (R 4.3.3)\n later            1.3.2      2023-12-06 [1] RSPM (R 4.3.0)\n lattice          0.22-5     2023-10-24 [1] CRAN (R 4.3.3)\n lifecycle        1.0.4      2023-11-07 [1] RSPM (R 4.3.0)\n lme4             1.1-35.5   2024-07-03 [1] CRAN (R 4.3.3)\n loo            * 2.7.0      2024-02-24 [1] CRAN (R 4.3.1)\n lubridate      * 1.9.4      2024-12-08 [1] CRAN (R 4.3.3)\n magrittr         2.0.3      2022-03-30 [1] RSPM (R 4.3.0)\n markdown         1.13       2024-06-04 [1] CRAN (R 4.3.3)\n MASS             7.3-60.0.1 2024-01-13 [1] RSPM (R 4.3.0)\n Matrix           1.6-5      2024-01-11 [1] CRAN (R 4.3.3)\n matrixStats      1.5.0      2025-01-07 [1] CRAN (R 4.3.3)\n memoise          2.0.1      2021-11-26 [1] RSPM (R 4.3.0)\n mime             0.12       2021-09-28 [1] RSPM (R 4.3.0)\n miniUI           0.1.1.1    2018-05-18 [1] RSPM (R 4.3.0)\n minqa            1.2.7      2024-05-20 [1] CRAN (R 4.3.3)\n nlme             3.1-164    2023-11-27 [1] CRAN (R 4.3.3)\n nloptr           2.1.1      2024-06-25 [1] CRAN (R 4.3.3)\n pillar           1.10.1     2025-01-07 [1] CRAN (R 4.3.3)\n pkgbuild         1.4.3      2023-12-10 [1] RSPM (R 4.3.0)\n pkgconfig        2.0.3      2019-09-22 [1] RSPM (R 4.3.0)\n pkgload          1.3.4      2024-01-16 [1] RSPM (R 4.3.0)\n plyr             1.8.9      2023-10-02 [1] RSPM (R 4.3.0)\n posterior      * 1.6.1      2025-02-27 [1] https://stan-dev.r-universe.dev (R 4.3.3)\n profvis          0.3.8      2023-05-02 [1] CRAN (R 4.3.0)\n promises         1.3.0      2024-04-05 [1] CRAN (R 4.3.1)\n purrr          * 1.0.4      2025-02-05 [1] CRAN (R 4.3.3)\n QuickJSR         1.3.1      2024-07-14 [1] CRAN (R 4.3.3)\n R6               2.6.1      2025-02-15 [1] CRAN (R 4.3.3)\n RColorBrewer     1.1-3      2022-04-03 [1] RSPM (R 4.3.0)\n Rcpp           * 1.0.13     2024-07-17 [1] CRAN (R 4.3.3)\n RcppParallel     5.1.9      2024-08-19 [1] CRAN (R 4.3.3)\n readr          * 2.1.5      2024-01-10 [1] RSPM (R 4.3.0)\n remotes          2.5.0      2024-03-17 [1] CRAN (R 4.3.1)\n reshape2         1.4.4      2020-04-09 [1] RSPM (R 4.3.0)\n rlang            1.1.5      2025-01-17 [1] CRAN (R 4.3.3)\n rmarkdown        2.27       2024-05-17 [1] CRAN (R 4.3.3)\n rprojroot        2.0.4      2023-11-05 [1] RSPM (R 4.3.0)\n rstan            2.32.6     2024-03-05 [1] CRAN (R 4.3.1)\n rstanarm         2.32.1     2024-01-18 [1] CRAN (R 4.3.1)\n rstanemax      * 0.1.9.1001 2025-02-17 [1] local\n rstantools       2.4.0      2024-01-31 [1] CRAN (R 4.3.1)\n rstudioapi       0.16.0     2024-03-24 [1] CRAN (R 4.3.1)\n S7               0.2.0      2024-11-07 [1] CRAN (R 4.3.3)\n scales           1.4.0      2025-04-24 [1] CRAN (R 4.3.3)\n sessioninfo      1.2.2      2021-12-06 [1] CRAN (R 4.3.0)\n shiny            1.9.1      2024-08-01 [1] CRAN (R 4.3.3)\n shinyjs          2.1.0      2021-12-23 [1] RSPM (R 4.3.0)\n shinystan        2.6.0      2022-03-03 [1] CRAN (R 4.3.0)\n shinythemes      1.2.0      2021-01-25 [1] CRAN (R 4.3.0)\n StanHeaders      2.32.9     2024-05-29 [1] CRAN (R 4.3.3)\n stringi          1.8.4      2024-05-06 [1] CRAN (R 4.3.1)\n stringr        * 1.5.1      2023-11-14 [1] RSPM (R 4.3.0)\n survival         3.7-0      2024-06-05 [1] CRAN (R 4.3.3)\n svUnit           1.0.6      2021-04-19 [1] CRAN (R 4.3.0)\n tensorA          0.36.2.1   2023-12-13 [1] CRAN (R 4.3.1)\n threejs          0.3.3      2020-01-21 [1] CRAN (R 4.3.0)\n tibble         * 3.2.1      2023-03-20 [1] RSPM (R 4.3.0)\n tidybayes      * 3.0.6      2023-08-12 [1] CRAN (R 4.3.0)\n tidyr          * 1.3.1      2024-01-24 [1] RSPM (R 4.3.0)\n tidyselect       1.2.1      2024-03-11 [1] CRAN (R 4.3.1)\n tidyverse      * 2.0.0      2023-02-22 [1] RSPM (R 4.3.0)\n timechange       0.3.0      2024-01-18 [1] RSPM (R 4.3.0)\n tzdb             0.4.0      2023-05-12 [1] RSPM (R 4.3.0)\n urlchecker       1.0.1      2021-11-30 [1] CRAN (R 4.3.0)\n usethis          2.2.3      2024-02-19 [1] CRAN (R 4.3.1)\n V8               5.0.0      2024-08-16 [1] CRAN (R 4.3.3)\n vctrs            0.6.5      2023-12-01 [1] RSPM (R 4.3.0)\n withr            3.0.2      2024-10-28 [1] CRAN (R 4.3.3)\n xfun             0.46       2024-07-18 [1] CRAN (R 4.3.3)\n xml2             1.3.6      2023-12-04 [1] RSPM (R 4.3.0)\n xtable           1.8-4      2019-04-21 [1] RSPM (R 4.3.0)\n xts              0.14.1     2024-10-15 [1] CRAN (R 4.3.3)\n yaml             2.3.10     2024-07-26 [1] CRAN (R 4.3.3)\n zoo              1.8-13     2025-02-22 [1] CRAN (R 4.3.3)\n\n [1] /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/library\n\n──────────────────────────────────────────────────────────────────────────────\n```\n\n\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}