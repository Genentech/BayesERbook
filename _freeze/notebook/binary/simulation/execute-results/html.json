{
  "hash": "843d7d8b934d649243a65a79ddeeadfd",
  "result": {
    "engine": "knitr",
    "markdown": "# Simulation\n\nThis page showcase the model simulation using the ER model for binary endpoint.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(BayesERtools)\nlibrary(posterior)\nlibrary(tidybayes)\nlibrary(bayesplot)\nlibrary(here)\nlibrary(gt)\n\ntheme_set(theme_bw(base_size = 12))\n```\n:::\n\n\n\n\n\n\n## Load data\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(d_sim_binom_cov)\n\nd_sim_binom_cov_2 <-\n  d_sim_binom_cov |>\n  mutate(\n    AUCss_1000 = AUCss / 1000, BAGE_10 = BAGE / 10,\n    BWT_10 = BWT / 10, BHBA1C_5 = BHBA1C / 5\n  )\n\n# Grade 2+ hypoglycemia\ndf_er_ae_hgly2 <- d_sim_binom_cov_2 |> filter(AETYPE == \"hgly2\")\n\nvar_resp <- \"AEFLAG\"\nvar_exposure <- \"AUCss_1000\"\n```\n:::\n\n\n\n\n## Fit model\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(1234)\nermod_bin_hgly2 <- dev_ermod_bin(\n  data = df_er_ae_hgly2,\n  var_resp = var_resp,\n  var_exposure = var_exposure\n)\nermod_bin_hgly2\n```\n\n<pre class=\"r-output\"><code>\n<span style='color: #00BBBB;'>──</span> <span style='font-weight: bold;'>Binary ER model</span> <span style='color: #00BBBB;'>─────────────────────────────────────────────────────────────</span>\n<span style='color: #00BBBB;'>ℹ</span> Use `plot_er()` to visualize ER curve\n\n── <span style='font-weight: bold;'>Developed model</span> ──\n\nstan_glm\n family:       binomial [logit]\n formula:      AEFLAG ~ AUCss_1000\n observations: 500\n predictors:   2\n------\n            Median MAD_SD\n(Intercept) -2.04   0.23 \nAUCss_1000   0.41   0.08 \n------\n* For help interpreting the printed output see ?print.stanreg\n* For info on the priors used see ?prior_summary.stanreg\n</code></pre>\n:::\n\n\n\n\n\n## Prediction at specific conc\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnew_conc_vec <- c(1, 3, 9)\n\n# Sim at specific conc\nd_sim_new_conc <-\n  sim_er_new_exp(ermod_bin_hgly2,\n    exposure_to_sim_vec  = new_conc_vec,\n    output_type = c(\"median_qi\"))\n\nd_sim_new_conc |>\n  select(-starts_with(\".linpred\"), -c(.row, .width, .point, .interval)) |>\n  gt() |>\n  fmt_number(decimals = 2) |>\n  tab_header(\n    title = md(\"Predicted probability of events at specific concentrations\")\n  )\n```\n\n::: {#fig-spec-conc-1 .cell-output-display}\n`````{=html}\n<pre class=\"r-output\"><code>\n```{=html}\n<div id=\"qnnknajtwb\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#qnnknajtwb table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#qnnknajtwb thead, #qnnknajtwb tbody, #qnnknajtwb tfoot, #qnnknajtwb tr, #qnnknajtwb td, #qnnknajtwb th {\n  border-style: none;\n}\n\n#qnnknajtwb p {\n  margin: 0;\n  padding: 0;\n}\n\n#qnnknajtwb .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#qnnknajtwb .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#qnnknajtwb .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#qnnknajtwb .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#qnnknajtwb .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#qnnknajtwb .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#qnnknajtwb .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#qnnknajtwb .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#qnnknajtwb .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#qnnknajtwb .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#qnnknajtwb .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#qnnknajtwb .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#qnnknajtwb .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#qnnknajtwb .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#qnnknajtwb .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#qnnknajtwb .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#qnnknajtwb .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#qnnknajtwb .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#qnnknajtwb .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#qnnknajtwb .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#qnnknajtwb .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#qnnknajtwb .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#qnnknajtwb .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#qnnknajtwb .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#qnnknajtwb .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#qnnknajtwb .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#qnnknajtwb .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#qnnknajtwb .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#qnnknajtwb .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#qnnknajtwb .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#qnnknajtwb .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#qnnknajtwb .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#qnnknajtwb .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#qnnknajtwb .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#qnnknajtwb .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#qnnknajtwb .gt_left {\n  text-align: left;\n}\n\n#qnnknajtwb .gt_center {\n  text-align: center;\n}\n\n#qnnknajtwb .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#qnnknajtwb .gt_font_normal {\n  font-weight: normal;\n}\n\n#qnnknajtwb .gt_font_bold {\n  font-weight: bold;\n}\n\n#qnnknajtwb .gt_font_italic {\n  font-style: italic;\n}\n\n#qnnknajtwb .gt_super {\n  font-size: 65%;\n}\n\n#qnnknajtwb .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#qnnknajtwb .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#qnnknajtwb .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#qnnknajtwb .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#qnnknajtwb .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#qnnknajtwb .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#qnnknajtwb .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#qnnknajtwb .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#qnnknajtwb div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_heading\">\n      <td colspan=\"4\" class=\"gt_heading gt_title gt_font_normal gt_bottom_border\" style><span data-qmd-base64=\"UHJlZGljdGVkIHByb2JhYmlsaXR5IG9mIGV2ZW50cyBhdCBzcGVjaWZpYyBjb25jZW50cmF0aW9ucw==\"><span class='gt_from_md'>Predicted probability of events at specific concentrations</span></span></td>\n    </tr>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"AUCss_1000\">AUCss_1000</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"a.epred\">.epred</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"a.epred.lower\">.epred.lower</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"a.epred.upper\">.epred.upper</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"AUCss_1000\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\".epred\" class=\"gt_row gt_right\">0.16</td>\n<td headers=\".epred.lower\" class=\"gt_row gt_right\">0.12</td>\n<td headers=\".epred.upper\" class=\"gt_row gt_right\">0.21</td></tr>\n    <tr><td headers=\"AUCss_1000\" class=\"gt_row gt_right\">3.00</td>\n<td headers=\".epred\" class=\"gt_row gt_right\">0.31</td>\n<td headers=\".epred.lower\" class=\"gt_row gt_right\">0.27</td>\n<td headers=\".epred.upper\" class=\"gt_row gt_right\">0.35</td></tr>\n    <tr><td headers=\"AUCss_1000\" class=\"gt_row gt_right\">9.00</td>\n<td headers=\".epred\" class=\"gt_row gt_right\">0.84</td>\n<td headers=\".epred.lower\" class=\"gt_row gt_right\">0.67</td>\n<td headers=\".epred.upper\" class=\"gt_row gt_right\">0.93</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n</code></pre>\n`````\n:::\n\n```{.r .cell-code}\n# Sim to draw ER curve\nd_sim_curve <-\n  sim_er_curve(ermod_bin_hgly2, output_type = c(\"median_qi\"))\n\nd_sim_curve |>\n  ggplot(aes(x = AUCss_1000, y = .epred)) +\n  # Emax model curve\n  geom_ribbon(aes(y = .epred, ymin = .epred.lower, ymax = .epred.upper),\n    alpha = 0.3, fill = \"deepskyblue\") +\n  geom_line(aes(y = .epred), color = \"deepskyblue\") +\n  # Prediction at the specified doses\n  geom_point(data = d_sim_new_conc, aes(y = .epred), color = \"tomato\", size = 3) +\n  geom_errorbar(data = d_sim_new_conc,\n    aes(y = .epred, ymin = .epred.lower, ymax = .epred.upper),\n    width = 0.03, color = \"tomato\") +\n  coord_cartesian(ylim = c(0, 1)) +\n  scale_y_continuous(\n    breaks = c(0, .5, 1),\n    labels = scales::percent\n  ) +\n  labs(\n    x = \"AUC~ss~ / 1000\", y = \"Probability of event\",\n    title = \"ER model predictions at new exposure levels\",\n    caption = \"Area: 95% credible interval\"\n  ) +\n  theme(axis.title.x = ggtext::element_markdown()) +\n  xgxr::xgx_scale_x_log10()\n```\n\n::: {.cell-output-display}\n![](simulation_files/figure-html/fig-spec-conc-1.png){#fig-spec-conc-2 width=672}\n:::\n:::\n\n\n\n\n## Prediction for new dose\n\n### Prep PK data for simulation\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(1234)\n\nd_new_dose_pk <-\n  tibble(Dose_mg = rep(c(100, 200, 400), each = 30)) |>\n  mutate(CL = rlnorm(n(), meanlog = log(100), sdlog = 0.3),\n    AUCss_1000 = Dose_mg / CL,\n    Dose = glue::glue(\"{Dose_mg} mg\"))\n\nd_median_auc <-\n  d_new_dose_pk |>\n  group_by(Dose) |>\n  summarize(AUCss_1000 = median(AUCss_1000))\n\nggplot(d_new_dose_pk, aes(x = AUCss_1000, fill = Dose)) +\n  geom_histogram(position = \"identity\", alpha = 0.5) +\n  labs(\n    x = \"AUC~ss~ / 1000\", y = \"Count\",\n    title = \"Distribution of AUC~ss~ for new doses\"\n  ) +\n  theme(plot.title = ggtext::element_markdown(),\n    axis.title.x = ggtext::element_markdown()) +\n  xgxr::xgx_scale_x_log10()\n```\n\n<pre class=\"r-output\"><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n</code></pre>::: {.cell-output-display}\n![](simulation_files/figure-html/fig-new-dose-data-1.png){#fig-new-dose-data width=672}\n:::\n:::\n\n\n\n\n### Sim and plot\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nd_sim_new_dose_raw <-\n  sim_er(ermod_bin_hgly2,\n    newdata = d_new_dose_pk)\n\nd_sim_new_dose_per_dose <-\n  d_sim_new_dose_raw |>\n  # Calc per-dose summary probability for each MCMC draws\n  ungroup() |>\n  summarize(prob = mean(.epred), .by = c(Dose, Dose_mg, .draw)) |>\n  # Summarize across MCMC draws\n  group_by(Dose, Dose_mg) |>\n  median_qi() |>\n  ungroup() |>\n  # Add median AUCss\n  left_join(d_median_auc, by = \"Dose\")\n\n\nd_sim_curve |>\n  ggplot(aes(x = AUCss_1000, y = .epred)) +\n  # Emax model curve\n  geom_ribbon(aes(y = .epred, ymin = .epred.lower, ymax = .epred.upper),\n    alpha = 0.3, fill = \"grey\") +\n  geom_line(aes(y = .epred), color = \"grey\") +\n  # Prediction at the specified doses\n  geom_point(data = d_sim_new_dose_per_dose, aes(y = prob, color = Dose), size = 3) +\n  geom_errorbar(data = d_sim_new_dose_per_dose,\n    aes(y = prob, ymin = .lower, ymax = .upper, color = Dose), width = 0.03) +\n  geom_boxplot(data = d_new_dose_pk,\n    aes(x = AUCss_1000, y = -0.1, fill = Dose, color = Dose), width = 0.1, alpha = 0.5,\n    inherit.aes = FALSE) +\n  geom_hline(yintercept = 0, linetype = \"solid\", linewidth = 0.2) +\n  coord_cartesian(ylim = c(-0.15, 1)) +\n  scale_y_continuous(\n    breaks = c(0, .5, 1),\n    labels = scales::percent\n  ) +\n  labs(\n    x = \"AUC~ss~ / 1000\", y = \"Probability of event\",\n    title = \"ER model predictions at new dose levels\",\n    caption = \"Area: 95% credible interval\n    Boxplot: Observed exposure levels\n    Symbols: Predicted mean probability for each dose and 95% CI\"\n  )  +\n  guides(\n    fill = guide_legend(reverse = TRUE),\n    color = guide_legend(reverse = TRUE)\n  ) +\n  theme(axis.title.x = ggtext::element_markdown()) +\n  xgxr::xgx_scale_x_log10()\n```\n\n::: {.cell-output-display}\n![](simulation_files/figure-html/fig-new-dose-sim-1.png){#fig-new-dose-sim width=672}\n:::\n:::\n\n\n\n\n## PK boxplot on ER plot\n\nWhen you use `plot_er_gof()` function, you can only add boxplot for the data\nthat you used for the model fit.\n\nSee below the example of adding exposure boxplot to any ER plot.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot_er(ermod_bin_hgly2, show_orig_data = TRUE) +\n  geom_boxplot(data = d_new_dose_pk,\n    aes(x = AUCss_1000, y = -0.2, fill = Dose, color = Dose), width = 0.1, alpha = 0.5,\n    inherit.aes = FALSE) +\n  geom_hline(yintercept = -0.1, linetype = \"solid\", linewidth = 0.2) +\n  coord_cartesian(ylim = c(-0.25, 1)) +\n  xgxr::xgx_scale_x_log10() +\n  guides(\n    fill = guide_legend(reverse = TRUE),\n    color = guide_legend(reverse = TRUE)\n  )\n```\n\n::: {.cell-output-display}\n![](simulation_files/figure-html/fig-er-and-obs-pk-1.png){#fig-er-and-obs-pk width=672}\n:::\n:::\n",
    "supporting": [
      "simulation_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}