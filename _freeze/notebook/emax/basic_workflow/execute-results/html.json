{
  "hash": "6db706238acc4bf75cf17369a205b77c",
  "result": {
    "engine": "knitr",
    "markdown": "# Basic workflow\n\nIn this section, we will show a basic workflow for performing an E~max~ model \nanalysis for continuous endpoint.\n\n## Setup and load\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(BayesERtools)\nlibrary(posterior)\nlibrary(tidybayes)\nlibrary(here)\nlibrary(gt)\n\ntheme_set(theme_bw(base_size = 12))\n```\n:::\n\n\n\n\n\n\n\n## Load data\n\nThe data for the example is included in the BayesERtools package, which contains a simulated data set `d_sim_emax`. The analysis uses the `exposure` variable to predict the continuous outcome `response_1`. The data are illustrated below:\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nd_sim_emax |>\n  head() |>\n  gt() |>\n  fmt_number(decimals = 2)\n```\n\n::: {#fig-data-look-1 .cell-output-display}\n`````{=html}\n<pre class=\"r-output\"><code>\n```{=html}\n<div id=\"zrhevfsifl\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#zrhevfsifl table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#zrhevfsifl thead, #zrhevfsifl tbody, #zrhevfsifl tfoot, #zrhevfsifl tr, #zrhevfsifl td, #zrhevfsifl th {\n  border-style: none;\n}\n\n#zrhevfsifl p {\n  margin: 0;\n  padding: 0;\n}\n\n#zrhevfsifl .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#zrhevfsifl .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#zrhevfsifl .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#zrhevfsifl .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#zrhevfsifl .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#zrhevfsifl .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#zrhevfsifl .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#zrhevfsifl .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#zrhevfsifl .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#zrhevfsifl .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#zrhevfsifl .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#zrhevfsifl .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#zrhevfsifl .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#zrhevfsifl .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#zrhevfsifl .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#zrhevfsifl .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#zrhevfsifl .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#zrhevfsifl .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#zrhevfsifl .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#zrhevfsifl .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#zrhevfsifl .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#zrhevfsifl .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#zrhevfsifl .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#zrhevfsifl .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#zrhevfsifl .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#zrhevfsifl .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#zrhevfsifl .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#zrhevfsifl .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#zrhevfsifl .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#zrhevfsifl .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#zrhevfsifl .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#zrhevfsifl .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#zrhevfsifl .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#zrhevfsifl .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#zrhevfsifl .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#zrhevfsifl .gt_left {\n  text-align: left;\n}\n\n#zrhevfsifl .gt_center {\n  text-align: center;\n}\n\n#zrhevfsifl .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#zrhevfsifl .gt_font_normal {\n  font-weight: normal;\n}\n\n#zrhevfsifl .gt_font_bold {\n  font-weight: bold;\n}\n\n#zrhevfsifl .gt_font_italic {\n  font-style: italic;\n}\n\n#zrhevfsifl .gt_super {\n  font-size: 65%;\n}\n\n#zrhevfsifl .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#zrhevfsifl .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#zrhevfsifl .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#zrhevfsifl .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#zrhevfsifl .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#zrhevfsifl .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#zrhevfsifl .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#zrhevfsifl .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#zrhevfsifl div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"dose\">dose</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"exposure\">exposure</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"response_1\">response_1</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"response_2\">response_2</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"cnt_a\">cnt_a</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"cnt_b\">cnt_b</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"cnt_c\">cnt_c</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"bin_d\">bin_d</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"bin_e\">bin_e</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"dose\" class=\"gt_row gt_right\">100.00</td>\n<td headers=\"exposure\" class=\"gt_row gt_right\">4,151.15</td>\n<td headers=\"response_1\" class=\"gt_row gt_right\">12.80</td>\n<td headers=\"response_2\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"cnt_a\" class=\"gt_row gt_right\">5.71</td>\n<td headers=\"cnt_b\" class=\"gt_row gt_right\">2.33</td>\n<td headers=\"cnt_c\" class=\"gt_row gt_right\">7.83</td>\n<td headers=\"bin_d\" class=\"gt_row gt_right\">0.00</td>\n<td headers=\"bin_e\" class=\"gt_row gt_right\">1.00</td></tr>\n    <tr><td headers=\"dose\" class=\"gt_row gt_right\">100.00</td>\n<td headers=\"exposure\" class=\"gt_row gt_right\">8,067.26</td>\n<td headers=\"response_1\" class=\"gt_row gt_right\">14.58</td>\n<td headers=\"response_2\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"cnt_a\" class=\"gt_row gt_right\">4.92</td>\n<td headers=\"cnt_b\" class=\"gt_row gt_right\">4.66</td>\n<td headers=\"cnt_c\" class=\"gt_row gt_right\">6.74</td>\n<td headers=\"bin_d\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"bin_e\" class=\"gt_row gt_right\">1.00</td></tr>\n    <tr><td headers=\"dose\" class=\"gt_row gt_right\">100.00</td>\n<td headers=\"exposure\" class=\"gt_row gt_right\">4,877.67</td>\n<td headers=\"response_1\" class=\"gt_row gt_right\">12.76</td>\n<td headers=\"response_2\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"cnt_a\" class=\"gt_row gt_right\">4.88</td>\n<td headers=\"cnt_b\" class=\"gt_row gt_right\">4.21</td>\n<td headers=\"cnt_c\" class=\"gt_row gt_right\">4.68</td>\n<td headers=\"bin_d\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"bin_e\" class=\"gt_row gt_right\">1.00</td></tr>\n    <tr><td headers=\"dose\" class=\"gt_row gt_right\">100.00</td>\n<td headers=\"exposure\" class=\"gt_row gt_right\">9,712.93</td>\n<td headers=\"response_1\" class=\"gt_row gt_right\">16.55</td>\n<td headers=\"response_2\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"cnt_a\" class=\"gt_row gt_right\">8.42</td>\n<td headers=\"cnt_b\" class=\"gt_row gt_right\">6.56</td>\n<td headers=\"cnt_c\" class=\"gt_row gt_right\">1.29</td>\n<td headers=\"bin_d\" class=\"gt_row gt_right\">0.00</td>\n<td headers=\"bin_e\" class=\"gt_row gt_right\">1.00</td></tr>\n    <tr><td headers=\"dose\" class=\"gt_row gt_right\">100.00</td>\n<td headers=\"exposure\" class=\"gt_row gt_right\">11,490.74</td>\n<td headers=\"response_1\" class=\"gt_row gt_right\">14.41</td>\n<td headers=\"response_2\" class=\"gt_row gt_right\">0.00</td>\n<td headers=\"cnt_a\" class=\"gt_row gt_right\">4.37</td>\n<td headers=\"cnt_b\" class=\"gt_row gt_right\">3.96</td>\n<td headers=\"cnt_c\" class=\"gt_row gt_right\">3.55</td>\n<td headers=\"bin_d\" class=\"gt_row gt_right\">0.00</td>\n<td headers=\"bin_e\" class=\"gt_row gt_right\">1.00</td></tr>\n    <tr><td headers=\"dose\" class=\"gt_row gt_right\">100.00</td>\n<td headers=\"exposure\" class=\"gt_row gt_right\">2,451.55</td>\n<td headers=\"response_1\" class=\"gt_row gt_right\">12.60</td>\n<td headers=\"response_2\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"cnt_a\" class=\"gt_row gt_right\">8.69</td>\n<td headers=\"cnt_b\" class=\"gt_row gt_right\">7.60</td>\n<td headers=\"cnt_c\" class=\"gt_row gt_right\">3.64</td>\n<td headers=\"bin_d\" class=\"gt_row gt_right\">0.00</td>\n<td headers=\"bin_e\" class=\"gt_row gt_right\">0.00</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n</code></pre>\n`````\n:::\n\n```{.r .cell-code}\nggplot(d_sim_emax, aes(exposure, response_1)) +\n  geom_point() +\n  geom_smooth(\n    formula = y ~ x, \n    method = \"loess\", \n    se = FALSE, \n    col = \"darkgrey\"\n  )\n```\n\n::: {.cell-output-display}\n![](basic_workflow_files/figure-html/fig-data-look-1.png){#fig-data-look-2 width=672}\n:::\n:::\n\n\n\n\n\n## Sigmoidal E~max~ model\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(1234)\n\nermod_sigemax <- dev_ermod_emax(\n  data = d_sim_emax,\n  var_resp = \"response_1\",\n  var_exposure = \"exposure\",\n  gamma_fix = NULL\n)\n\nermod_sigemax\n```\n\n<pre class=\"r-output\"><code>\n<span style='color: #00BBBB;'>──</span> <span style='font-weight: bold;'>Emax model</span> <span style='color: #00BBBB;'>──────────────────────────────────────────────────────────────────</span>\n<span style='color: #00BBBB;'>ℹ</span> Use `plot_er()` to visualize ER curve\n\n── <span style='font-weight: bold;'>Developed model</span> ──\n\n---- Emax model fit with rstanemax ----\n         mean se_mean      sd   2.5%     25%     50%     75%    97.5%   n_eff\nemax    11.59    0.31    5.89   4.82    7.34   10.10   14.24    27.50  368.24\ne0       6.68    0.20    4.08  -3.67    4.78    7.68    9.71    11.48  436.14\nec50  5254.72  193.00 4475.71 801.17 2974.18 4673.97 6385.68 15736.00  537.81\ngamma    1.06    0.02    0.50   0.32    0.70    0.97    1.33     2.26  543.20\nsigma    1.27    0.00    0.05   1.18    1.24    1.27    1.31     1.39 1375.87\n      Rhat\nemax  1.01\ne0    1.01\nec50  1.00\ngamma 1.01\nsigma 1.00\n* Use `extract_stanfit()` function to extract raw stanfit object\n* Use `extract_param()` function to extract posterior draws of key parameters\n* Use `plot()` function to visualize model fit\n* Use `posterior_predict()` or `posterior_predict_quantile()` function to get\n  raw predictions or make predictions on new data\n* Use `extract_obs_mod_frame()` function to extract raw data \n  in a processed format (useful for plotting)\n</code></pre>\n:::\n\n\n\n\n\n## Observation vs model fit\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nd_sim_ermod_sigemax <-\n  sim_er(ermod_sigemax, output_type = c(\"median_qi\"))\n\nplot_er_gof(d_sim_ermod_sigemax)\n```\n\n::: {.cell-output-display}\n![](basic_workflow_files/figure-html/fig-plot-er-1.png){#fig-plot-er width=672}\n:::\n:::\n\n\n\n\n\n## Parameter estimates\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nd_draws_sigemax <- as_draws_df(ermod_sigemax)\n\nd_draws_sigemax_summary <-\n  summarize_draws(d_draws_sigemax)\n\nec50_mean <-\n  d_draws_sigemax_summary |>\n  filter(variable == \"ec50\") |>\n  pull(mean)\n\nd_draws_sigemax_summary |>\n  gt() |>\n  fmt_number(decimals = 2)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<pre class=\"r-output\"><code>\n```{=html}\n<div id=\"qnnknajtwb\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#qnnknajtwb table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#qnnknajtwb thead, #qnnknajtwb tbody, #qnnknajtwb tfoot, #qnnknajtwb tr, #qnnknajtwb td, #qnnknajtwb th {\n  border-style: none;\n}\n\n#qnnknajtwb p {\n  margin: 0;\n  padding: 0;\n}\n\n#qnnknajtwb .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#qnnknajtwb .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#qnnknajtwb .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#qnnknajtwb .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#qnnknajtwb .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#qnnknajtwb .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#qnnknajtwb .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#qnnknajtwb .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#qnnknajtwb .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#qnnknajtwb .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#qnnknajtwb .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#qnnknajtwb .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#qnnknajtwb .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#qnnknajtwb .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#qnnknajtwb .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#qnnknajtwb .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#qnnknajtwb .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#qnnknajtwb .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#qnnknajtwb .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#qnnknajtwb .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#qnnknajtwb .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#qnnknajtwb .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#qnnknajtwb .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#qnnknajtwb .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#qnnknajtwb .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#qnnknajtwb .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#qnnknajtwb .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#qnnknajtwb .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#qnnknajtwb .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#qnnknajtwb .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#qnnknajtwb .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#qnnknajtwb .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#qnnknajtwb .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#qnnknajtwb .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#qnnknajtwb .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#qnnknajtwb .gt_left {\n  text-align: left;\n}\n\n#qnnknajtwb .gt_center {\n  text-align: center;\n}\n\n#qnnknajtwb .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#qnnknajtwb .gt_font_normal {\n  font-weight: normal;\n}\n\n#qnnknajtwb .gt_font_bold {\n  font-weight: bold;\n}\n\n#qnnknajtwb .gt_font_italic {\n  font-style: italic;\n}\n\n#qnnknajtwb .gt_super {\n  font-size: 65%;\n}\n\n#qnnknajtwb .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#qnnknajtwb .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#qnnknajtwb .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#qnnknajtwb .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#qnnknajtwb .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#qnnknajtwb .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#qnnknajtwb .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#qnnknajtwb .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#qnnknajtwb div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"variable\">variable</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"mean\">mean</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"median\">median</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"sd\">sd</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"mad\">mad</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"q5\">q5</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"q95\">q95</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"rhat\">rhat</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"ess_bulk\">ess_bulk</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"ess_tail\">ess_tail</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">ec50</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">5,254.72</td>\n<td headers=\"median\" class=\"gt_row gt_right\">4,673.97</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">4,475.71</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">2,534.11</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">1,125.57</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">9,837.30</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.01</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">614.40</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">541.30</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">sigma</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">1.27</td>\n<td headers=\"median\" class=\"gt_row gt_right\">1.27</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">0.05</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">0.05</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">1.19</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">1.36</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">1,379.24</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">1,505.63</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">gamma</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">1.06</td>\n<td headers=\"median\" class=\"gt_row gt_right\">0.97</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">0.50</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">0.45</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">0.40</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">2.04</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.01</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">459.99</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">555.58</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">e0</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">6.68</td>\n<td headers=\"median\" class=\"gt_row gt_right\">7.68</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">4.08</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">3.42</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">−1.45</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">11.20</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.01</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">480.68</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">788.66</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">emax</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">11.59</td>\n<td headers=\"median\" class=\"gt_row gt_right\">10.10</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">5.89</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">4.79</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">5.20</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">23.06</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.01</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">429.41</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">533.51</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n</code></pre>\n`````\n:::\n:::\n\n\n\n\n\n## Prediction at a certain concentrations\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nd_sim_new_conc <-\n  sim_er_new_exp(ermod_sigemax,\n    exposure_to_sim_vec  = c(5000, 15000, 25000, 35000),\n    output_type = c(\"median_qi\"))\n\nd_sim_new_conc |>\n  select(-starts_with(\".linpred\"), -c(.row, .width, .point, .interval)) |>\n  gt() |>\n  fmt_number(decimals = 2) |>\n  tab_header(\n    title = md(\"Prediction at specific concentrations\")\n  )\n```\n\n::: {#fig-plot-er-new-conc-1 .cell-output-display}\n`````{=html}\n<pre class=\"r-output\"><code>\n```{=html}\n<div id=\"oslyshlwzm\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#oslyshlwzm table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#oslyshlwzm thead, #oslyshlwzm tbody, #oslyshlwzm tfoot, #oslyshlwzm tr, #oslyshlwzm td, #oslyshlwzm th {\n  border-style: none;\n}\n\n#oslyshlwzm p {\n  margin: 0;\n  padding: 0;\n}\n\n#oslyshlwzm .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#oslyshlwzm .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#oslyshlwzm .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#oslyshlwzm .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#oslyshlwzm .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#oslyshlwzm .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#oslyshlwzm .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#oslyshlwzm .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#oslyshlwzm .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#oslyshlwzm .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#oslyshlwzm .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#oslyshlwzm .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#oslyshlwzm .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#oslyshlwzm .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#oslyshlwzm .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#oslyshlwzm .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#oslyshlwzm .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#oslyshlwzm .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#oslyshlwzm .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#oslyshlwzm .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#oslyshlwzm .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#oslyshlwzm .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#oslyshlwzm .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#oslyshlwzm .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#oslyshlwzm .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#oslyshlwzm .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#oslyshlwzm .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#oslyshlwzm .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#oslyshlwzm .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#oslyshlwzm .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#oslyshlwzm .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#oslyshlwzm .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#oslyshlwzm .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#oslyshlwzm .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#oslyshlwzm .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#oslyshlwzm .gt_left {\n  text-align: left;\n}\n\n#oslyshlwzm .gt_center {\n  text-align: center;\n}\n\n#oslyshlwzm .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#oslyshlwzm .gt_font_normal {\n  font-weight: normal;\n}\n\n#oslyshlwzm .gt_font_bold {\n  font-weight: bold;\n}\n\n#oslyshlwzm .gt_font_italic {\n  font-style: italic;\n}\n\n#oslyshlwzm .gt_super {\n  font-size: 65%;\n}\n\n#oslyshlwzm .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#oslyshlwzm .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#oslyshlwzm .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#oslyshlwzm .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#oslyshlwzm .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#oslyshlwzm .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#oslyshlwzm .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#oslyshlwzm .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#oslyshlwzm div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_heading\">\n      <td colspan=\"7\" class=\"gt_heading gt_title gt_font_normal gt_bottom_border\" style><span data-qmd-base64=\"UHJlZGljdGlvbiBhdCBzcGVjaWZpYyBjb25jZW50cmF0aW9ucw==\"><span class='gt_from_md'>Prediction at specific concentrations</span></span></td>\n    </tr>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"exposure\">exposure</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"a.epred\">.epred</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"a.epred.lower\">.epred.lower</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"a.epred.upper\">.epred.upper</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"a.prediction\">.prediction</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"a.prediction.lower\">.prediction.lower</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"a.prediction.upper\">.prediction.upper</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"exposure\" class=\"gt_row gt_right\">5,000.00</td>\n<td headers=\".epred\" class=\"gt_row gt_right\">13.05</td>\n<td headers=\".epred.lower\" class=\"gt_row gt_right\">12.79</td>\n<td headers=\".epred.upper\" class=\"gt_row gt_right\">13.30</td>\n<td headers=\".prediction\" class=\"gt_row gt_right\">13.04</td>\n<td headers=\".prediction.lower\" class=\"gt_row gt_right\">10.49</td>\n<td headers=\".prediction.upper\" class=\"gt_row gt_right\">15.57</td></tr>\n    <tr><td headers=\"exposure\" class=\"gt_row gt_right\">15,000.00</td>\n<td headers=\".epred\" class=\"gt_row gt_right\">15.33</td>\n<td headers=\".epred.lower\" class=\"gt_row gt_right\">15.12</td>\n<td headers=\".epred.upper\" class=\"gt_row gt_right\">15.54</td>\n<td headers=\".prediction\" class=\"gt_row gt_right\">15.36</td>\n<td headers=\".prediction.lower\" class=\"gt_row gt_right\">12.86</td>\n<td headers=\".prediction.upper\" class=\"gt_row gt_right\">17.85</td></tr>\n    <tr><td headers=\"exposure\" class=\"gt_row gt_right\">25,000.00</td>\n<td headers=\".epred\" class=\"gt_row gt_right\">16.05</td>\n<td headers=\".epred.lower\" class=\"gt_row gt_right\">15.75</td>\n<td headers=\".epred.upper\" class=\"gt_row gt_right\">16.36</td>\n<td headers=\".prediction\" class=\"gt_row gt_right\">16.05</td>\n<td headers=\".prediction.lower\" class=\"gt_row gt_right\">13.57</td>\n<td headers=\".prediction.upper\" class=\"gt_row gt_right\">18.56</td></tr>\n    <tr><td headers=\"exposure\" class=\"gt_row gt_right\">35,000.00</td>\n<td headers=\".epred\" class=\"gt_row gt_right\">16.40</td>\n<td headers=\".epred.lower\" class=\"gt_row gt_right\">15.91</td>\n<td headers=\".epred.upper\" class=\"gt_row gt_right\">16.95</td>\n<td headers=\".prediction\" class=\"gt_row gt_right\">16.42</td>\n<td headers=\".prediction.lower\" class=\"gt_row gt_right\">13.83</td>\n<td headers=\".prediction.upper\" class=\"gt_row gt_right\">18.92</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n</code></pre>\n`````\n:::\n\n```{.r .cell-code}\nd_sim_ermod_sigemax |>\n  ggplot(aes(x = exposure, y = response_1)) +\n  # Emax model curve\n  geom_vline(\n    xintercept = ec50_mean, \n    linetype = \"dashed\", \n    color = \"deepskyblue\"\n  ) +\n  geom_ribbon(\n    mapping = aes(\n      y = .epred, \n      ymin = .epred.lower, \n      ymax = .epred.upper\n    ),\n    alpha = 0.3, \n    fill = \"deepskyblue\"\n  ) +\n  geom_line(\n    mapping = aes(y = .epred), \n    color = \"deepskyblue\"\n  ) +\n  # Observed data\n  geom_point(\n    data = d_sim_emax, \n    color = \"grey\"\n  ) +\n  # Prediction at the specified doses\n  geom_point(\n    data = d_sim_new_conc, \n    mapping = aes(y = .epred), \n    color = \"tomato\", \n    size = 3\n  ) +\n  geom_errorbar(\n    data = d_sim_new_conc,\n    mapping = aes(\n      y = .epred, \n      ymin = .epred.lower, \n      ymax = .epred.upper\n    ),\n    width = 1, \n    color = \"tomato\"\n  ) +\n  coord_cartesian(ylim = c(7, 21)) +\n  scale_fill_brewer(palette = \"Greys\") +\n  labs(\n    title = \"Sigmoidal E~max~ model predictions at new exposure levels\",\n    caption = paste(\n      \"vertical dashed line: estimated EC~50~ value\",\n      \"area: 95% credible interval\", \n      sep = \"<br>\"\n    )\n  ) +\n  theme(\n    plot.title = ggtext::element_markdown(),\n    plot.caption = ggtext::element_markdown()\n  )\n```\n\n::: {.cell-output-display}\n![](basic_workflow_files/figure-html/fig-plot-er-new-conc-1.png){#fig-plot-er-new-conc-2 width=672}\n:::\n:::\n",
    "supporting": [
      "basic_workflow_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}