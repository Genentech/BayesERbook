{
  "hash": "702afada72c3b9fe128d1858fb2c2920",
  "result": {
    "engine": "knitr",
    "markdown": "# Basic workflow\n\nIn this section, we will show a basic workflow for performing an E~max~ model \nanalysis for continuous endpoint.\n\n## Setup and load\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(BayesERtools)\nlibrary(posterior)\nlibrary(tidybayes)\nlibrary(here)\nlibrary(gt)\n\ntheme_set(theme_bw(base_size = 12))\n```\n:::\n\n\n\n\n\n\n\n## Load data\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nd_example_emax_nocov <- read_csv(here(\"data\", \"d_example_emax_nocov.csv\"))\n\nd_example_emax_nocov |>\n  head() |>\n  gt() |>\n  fmt_number(decimals = 2)\n```\n\n::: {#fig-data-look-1 .cell-output-display}\n\n```{=html}\n<div id=\"hpeigfyyjf\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#hpeigfyyjf table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#hpeigfyyjf thead, #hpeigfyyjf tbody, #hpeigfyyjf tfoot, #hpeigfyyjf tr, #hpeigfyyjf td, #hpeigfyyjf th {\n  border-style: none;\n}\n\n#hpeigfyyjf p {\n  margin: 0;\n  padding: 0;\n}\n\n#hpeigfyyjf .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#hpeigfyyjf .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#hpeigfyyjf .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#hpeigfyyjf .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#hpeigfyyjf .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#hpeigfyyjf .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#hpeigfyyjf .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#hpeigfyyjf .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#hpeigfyyjf .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#hpeigfyyjf .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#hpeigfyyjf .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#hpeigfyyjf .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#hpeigfyyjf .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#hpeigfyyjf .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#hpeigfyyjf .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#hpeigfyyjf .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#hpeigfyyjf .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#hpeigfyyjf .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#hpeigfyyjf .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hpeigfyyjf .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#hpeigfyyjf .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#hpeigfyyjf .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#hpeigfyyjf .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hpeigfyyjf .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#hpeigfyyjf .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#hpeigfyyjf .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#hpeigfyyjf .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hpeigfyyjf .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#hpeigfyyjf .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#hpeigfyyjf .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#hpeigfyyjf .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#hpeigfyyjf .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#hpeigfyyjf .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hpeigfyyjf .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#hpeigfyyjf .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hpeigfyyjf .gt_left {\n  text-align: left;\n}\n\n#hpeigfyyjf .gt_center {\n  text-align: center;\n}\n\n#hpeigfyyjf .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#hpeigfyyjf .gt_font_normal {\n  font-weight: normal;\n}\n\n#hpeigfyyjf .gt_font_bold {\n  font-weight: bold;\n}\n\n#hpeigfyyjf .gt_font_italic {\n  font-style: italic;\n}\n\n#hpeigfyyjf .gt_super {\n  font-size: 65%;\n}\n\n#hpeigfyyjf .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#hpeigfyyjf .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#hpeigfyyjf .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#hpeigfyyjf .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#hpeigfyyjf .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#hpeigfyyjf .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#hpeigfyyjf .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#hpeigfyyjf .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#hpeigfyyjf div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Conc\">Conc</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Y\">Y</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"Conc\" class=\"gt_row gt_right\">47.51</td>\n<td headers=\"Y\" class=\"gt_row gt_right\">15.14</td></tr>\n    <tr><td headers=\"Conc\" class=\"gt_row gt_right\">12.44</td>\n<td headers=\"Y\" class=\"gt_row gt_right\">7.26</td></tr>\n    <tr><td headers=\"Conc\" class=\"gt_row gt_right\">14.90</td>\n<td headers=\"Y\" class=\"gt_row gt_right\">8.78</td></tr>\n    <tr><td headers=\"Conc\" class=\"gt_row gt_right\">13.62</td>\n<td headers=\"Y\" class=\"gt_row gt_right\">7.05</td></tr>\n    <tr><td headers=\"Conc\" class=\"gt_row gt_right\">29.16</td>\n<td headers=\"Y\" class=\"gt_row gt_right\">10.82</td></tr>\n    <tr><td headers=\"Conc\" class=\"gt_row gt_right\">45.16</td>\n<td headers=\"Y\" class=\"gt_row gt_right\">13.27</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n\n```{.r .cell-code}\nggplot(d_example_emax_nocov, aes(Conc, Y)) +\n  geom_point() +\n  geom_smooth(formula = y ~ x, method = \"loess\", se = F, col = \"darkgrey\")\n```\n\n::: {.cell-output-display}\n![](basic_workflow_files/figure-html/fig-data-look-1.png){#fig-data-look-2 width=672}\n:::\n:::\n\n\n\n\n## Sigmoidal E~max~ model\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(1234)\n\nermod_sigemax <- dev_ermod_emax(\n  data = d_example_emax_nocov,\n  var_resp = \"Y\",\n  var_exposure = \"Conc\",\n  gamma_fix = NULL\n)\n\nermod_sigemax\n```\n\n<pre class=\"r-output\"><code>\n<span style='color: #00BBBB;'>──</span> <span style='font-weight: bold;'>Emax model</span> <span style='color: #00BBBB;'>──────────────────────────────────────────────────────────────────</span>\n<span style='color: #00BBBB;'>ℹ</span> Use `plot_er()` to visualize ER curve\n\n── <span style='font-weight: bold;'>Developed model</span> ──\n\n---- Emax model fit with rstanemax ----\n       mean se_mean   sd  2.5%   25%   50%   75% 97.5%   n_eff Rhat\nemax  15.92    0.24 5.49  8.67 11.64 14.71 19.07 29.38  545.77 1.01\ne0     3.13    0.09 2.00 -2.15  2.25  3.58  4.54  5.62  550.23 1.00\nec50  24.94    0.30 8.63 14.98 19.47 22.51 28.06 48.31  843.12 1.00\ngamma  1.77    0.03 0.77  0.75  1.22  1.62  2.19  3.54  664.61 1.00\nsigma  0.86    0.00 0.16  0.62  0.75  0.84  0.95  1.24 1348.22 1.00\n* Use `extract_stanfit()` function to extract raw stanfit object\n* Use `extract_param()` function to extract posterior draws of key parameters\n* Use `plot()` function to visualize model fit\n* Use `posterior_predict()` or `posterior_predict_quantile()` function to get\n  raw predictions or make predictions on new data\n* Use `extract_obs_mod_frame()` function to extract raw data \n  in a processed format (useful for plotting)\n</code></pre>\n:::\n\n\n\n\n## Observation vs model fit\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nd_sim_ermod_sigemax <-\n  sim_er(ermod_sigemax, output_type = c(\"median_qi\"))\n\nplot_er_gof(d_sim_ermod_sigemax)\n```\n\n::: {.cell-output-display}\n![](basic_workflow_files/figure-html/fig-plot-er-1.png){#fig-plot-er width=672}\n:::\n:::\n\n\n\n\n## Parameter estimates\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nd_draws_sigemax <- as_draws_df(ermod_sigemax)\n\nd_draws_sigemax_summary <-\n  summarize_draws(d_draws_sigemax)\n\nec50_mean <-\n  d_draws_sigemax_summary |>\n  filter(variable == \"ec50\") |>\n  pull(mean)\n\nd_draws_sigemax_summary |>\n  gt() |>\n  fmt_number(decimals = 2)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"rwwztdciov\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#rwwztdciov table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#rwwztdciov thead, #rwwztdciov tbody, #rwwztdciov tfoot, #rwwztdciov tr, #rwwztdciov td, #rwwztdciov th {\n  border-style: none;\n}\n\n#rwwztdciov p {\n  margin: 0;\n  padding: 0;\n}\n\n#rwwztdciov .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#rwwztdciov .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#rwwztdciov .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#rwwztdciov .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#rwwztdciov .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#rwwztdciov .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#rwwztdciov .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#rwwztdciov .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#rwwztdciov .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#rwwztdciov .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#rwwztdciov .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#rwwztdciov .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#rwwztdciov .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#rwwztdciov .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#rwwztdciov .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#rwwztdciov .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#rwwztdciov .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#rwwztdciov .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#rwwztdciov .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#rwwztdciov .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#rwwztdciov .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#rwwztdciov .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#rwwztdciov .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#rwwztdciov .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#rwwztdciov .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#rwwztdciov .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#rwwztdciov .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#rwwztdciov .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#rwwztdciov .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#rwwztdciov .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#rwwztdciov .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#rwwztdciov .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#rwwztdciov .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#rwwztdciov .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#rwwztdciov .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#rwwztdciov .gt_left {\n  text-align: left;\n}\n\n#rwwztdciov .gt_center {\n  text-align: center;\n}\n\n#rwwztdciov .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#rwwztdciov .gt_font_normal {\n  font-weight: normal;\n}\n\n#rwwztdciov .gt_font_bold {\n  font-weight: bold;\n}\n\n#rwwztdciov .gt_font_italic {\n  font-style: italic;\n}\n\n#rwwztdciov .gt_super {\n  font-size: 65%;\n}\n\n#rwwztdciov .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#rwwztdciov .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#rwwztdciov .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#rwwztdciov .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#rwwztdciov .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#rwwztdciov .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#rwwztdciov .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#rwwztdciov .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#rwwztdciov div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"variable\">variable</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"mean\">mean</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"median\">median</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"sd\">sd</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"mad\">mad</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"q5\">q5</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"q95\">q95</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"rhat\">rhat</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"ess_bulk\">ess_bulk</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"ess_tail\">ess_tail</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">ec50</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">24.94</td>\n<td headers=\"median\" class=\"gt_row gt_right\">22.51</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">8.63</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">5.65</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">16.17</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">42.09</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">1,111.48</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">1,157.42</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">sigma</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">0.86</td>\n<td headers=\"median\" class=\"gt_row gt_right\">0.84</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">0.16</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">0.15</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">0.64</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">1.15</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">1,434.70</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">1,777.17</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">gamma</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">1.77</td>\n<td headers=\"median\" class=\"gt_row gt_right\">1.62</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">0.77</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">0.68</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">0.84</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">3.12</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">593.05</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">951.82</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">e0</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">3.13</td>\n<td headers=\"median\" class=\"gt_row gt_right\">3.58</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">2.00</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">1.62</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">−0.84</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">5.38</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">675.84</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">809.63</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">emax</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">15.92</td>\n<td headers=\"median\" class=\"gt_row gt_right\">14.71</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">5.49</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">5.13</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">9.35</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">26.51</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">583.13</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">809.81</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n\n\n## Prediction at a certain concentrations\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nd_sim_new_conc <-\n  sim_er_new_exp(ermod_sigemax,\n    exposure_to_sim_vec  = c(10, 20, 30, 50),\n    output_type = c(\"median_qi\"))\n\nd_sim_new_conc |>\n  select(-starts_with(\".linpred\"), -c(.row, .width, .point, .interval)) |>\n  gt() |>\n  fmt_number(decimals = 2) |>\n  tab_header(\n    title = md(\"Prediction at specific concentrations\")\n  )\n```\n\n::: {#fig-plot-er-new-conc-1 .cell-output-display}\n\n```{=html}\n<div id=\"stnbwnyble\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#stnbwnyble table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#stnbwnyble thead, #stnbwnyble tbody, #stnbwnyble tfoot, #stnbwnyble tr, #stnbwnyble td, #stnbwnyble th {\n  border-style: none;\n}\n\n#stnbwnyble p {\n  margin: 0;\n  padding: 0;\n}\n\n#stnbwnyble .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#stnbwnyble .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#stnbwnyble .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#stnbwnyble .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#stnbwnyble .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#stnbwnyble .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#stnbwnyble .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#stnbwnyble .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#stnbwnyble .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#stnbwnyble .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#stnbwnyble .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#stnbwnyble .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#stnbwnyble .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#stnbwnyble .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#stnbwnyble .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#stnbwnyble .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#stnbwnyble .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#stnbwnyble .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#stnbwnyble .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#stnbwnyble .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#stnbwnyble .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#stnbwnyble .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#stnbwnyble .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#stnbwnyble .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#stnbwnyble .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#stnbwnyble .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#stnbwnyble .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#stnbwnyble .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#stnbwnyble .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#stnbwnyble .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#stnbwnyble .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#stnbwnyble .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#stnbwnyble .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#stnbwnyble .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#stnbwnyble .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#stnbwnyble .gt_left {\n  text-align: left;\n}\n\n#stnbwnyble .gt_center {\n  text-align: center;\n}\n\n#stnbwnyble .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#stnbwnyble .gt_font_normal {\n  font-weight: normal;\n}\n\n#stnbwnyble .gt_font_bold {\n  font-weight: bold;\n}\n\n#stnbwnyble .gt_font_italic {\n  font-style: italic;\n}\n\n#stnbwnyble .gt_super {\n  font-size: 65%;\n}\n\n#stnbwnyble .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#stnbwnyble .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#stnbwnyble .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#stnbwnyble .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#stnbwnyble .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#stnbwnyble .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#stnbwnyble .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#stnbwnyble .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#stnbwnyble div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_heading\">\n      <td colspan=\"7\" class=\"gt_heading gt_title gt_font_normal gt_bottom_border\" style><span data-qmd-base64=\"UHJlZGljdGlvbiBhdCBzcGVjaWZpYyBjb25jZW50cmF0aW9ucw==\"><span class='gt_from_md'>Prediction at specific concentrations</span></span></td>\n    </tr>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Conc\">Conc</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"a.epred\">.epred</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"a.epred.lower\">.epred.lower</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"a.epred.upper\">.epred.upper</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"a.prediction\">.prediction</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"a.prediction.lower\">.prediction.lower</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"a.prediction.upper\">.prediction.upper</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"Conc\" class=\"gt_row gt_right\">10.00</td>\n<td headers=\".epred\" class=\"gt_row gt_right\">6.57</td>\n<td headers=\".epred.lower\" class=\"gt_row gt_right\">5.95</td>\n<td headers=\".epred.upper\" class=\"gt_row gt_right\">7.16</td>\n<td headers=\".prediction\" class=\"gt_row gt_right\">6.56</td>\n<td headers=\".prediction.lower\" class=\"gt_row gt_right\">4.77</td>\n<td headers=\".prediction.upper\" class=\"gt_row gt_right\">8.40</td></tr>\n    <tr><td headers=\"Conc\" class=\"gt_row gt_right\">20.00</td>\n<td headers=\".epred\" class=\"gt_row gt_right\">10.04</td>\n<td headers=\".epred.lower\" class=\"gt_row gt_right\">9.39</td>\n<td headers=\".epred.upper\" class=\"gt_row gt_right\">10.77</td>\n<td headers=\".prediction\" class=\"gt_row gt_right\">10.04</td>\n<td headers=\".prediction.lower\" class=\"gt_row gt_right\">8.24</td>\n<td headers=\".prediction.upper\" class=\"gt_row gt_right\">11.97</td></tr>\n    <tr><td headers=\"Conc\" class=\"gt_row gt_right\">30.00</td>\n<td headers=\".epred\" class=\"gt_row gt_right\">12.38</td>\n<td headers=\".epred.lower\" class=\"gt_row gt_right\">11.78</td>\n<td headers=\".epred.upper\" class=\"gt_row gt_right\">13.02</td>\n<td headers=\".prediction\" class=\"gt_row gt_right\">12.38</td>\n<td headers=\".prediction.lower\" class=\"gt_row gt_right\">10.47</td>\n<td headers=\".prediction.upper\" class=\"gt_row gt_right\">14.34</td></tr>\n    <tr><td headers=\"Conc\" class=\"gt_row gt_right\">50.00</td>\n<td headers=\".epred\" class=\"gt_row gt_right\">14.76</td>\n<td headers=\".epred.lower\" class=\"gt_row gt_right\">13.55</td>\n<td headers=\".epred.upper\" class=\"gt_row gt_right\">15.93</td>\n<td headers=\".prediction\" class=\"gt_row gt_right\">14.75</td>\n<td headers=\".prediction.lower\" class=\"gt_row gt_right\">12.50</td>\n<td headers=\".prediction.upper\" class=\"gt_row gt_right\">16.78</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n\n```{.r .cell-code}\nd_sim_ermod_sigemax |>\n  ggplot(aes(x = Conc, y = Y)) +\n  # Emax model curve\n  geom_vline(xintercept = ec50_mean, linetype = \"dashed\", color = \"deepskyblue\") +\n  geom_ribbon(aes(y = .epred, ymin = .epred.lower, ymax = .epred.upper),\n    alpha = 0.3, fill = \"deepskyblue\") +\n  geom_line(aes(y = .epred), color = \"deepskyblue\") +\n  # Observed data\n  geom_point(data = d_example_emax_nocov, color = \"grey\") +\n  # Prediction at the specified doses\n  geom_point(data = d_sim_new_conc, aes(y = .epred), color = \"tomato\", size = 3) +\n  geom_errorbar(data = d_sim_new_conc,\n    aes(y = .epred, ymin = .epred.lower, ymax = .epred.upper),\n    width = 1, color = \"tomato\") +\n  coord_cartesian(ylim = c(-1, 17)) +\n  scale_fill_brewer(palette = \"Greys\") +\n  labs(\n    title = \"Sigmoidal E~max~ model predictions at new exposure levels\",\n    caption =\n      \"vertical dashed line: estimated EC~50~ value<br>area: 95% credible interval\") +\n  theme(plot.title = ggtext::element_markdown(),\n    plot.caption = ggtext::element_markdown())\n```\n\n::: {.cell-output-display}\n![](basic_workflow_files/figure-html/fig-plot-er-new-conc-1.png){#fig-plot-er-new-conc-2 width=672}\n:::\n:::\n",
    "supporting": [
      "basic_workflow_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}