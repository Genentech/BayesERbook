{
  "hash": "b51c39539ae58e903a39f3a9fdb7ddaf",
  "result": {
    "engine": "knitr",
    "markdown": "# Model diagnostics & comparison\n\nThis page showcase the model diagnosis and comparison for the E~max~ model \n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(BayesERtools)\nlibrary(posterior)\nlibrary(tidybayes)\nlibrary(bayesplot)\nlibrary(loo)\nlibrary(here)\nlibrary(gt)\n\ntheme_set(theme_bw(base_size = 12))\n```\n:::\n\n\n\n\n\n\n\n## Load data\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nd_sim_emax\n```\n\n<pre class=\"r-output\"><code><span style='color: #555555;'># A tibble: 300 × 9</span>\n    dose exposure response_1 response_2 cnt_a cnt_b cnt_c bin_d bin_e\n   <span style='color: #555555; font-style: italic;'><dbl></span>    <span style='color: #555555; font-style: italic;'><dbl></span>      <span style='color: #555555; font-style: italic;'><dbl></span>      <span style='color: #555555; font-style: italic;'><dbl></span> <span style='color: #555555; font-style: italic;'><dbl></span> <span style='color: #555555; font-style: italic;'><dbl></span> <span style='color: #555555; font-style: italic;'><dbl></span> <span style='color: #555555; font-style: italic;'><dbl></span> <span style='color: #555555; font-style: italic;'><dbl></span>\n<span style='color: #555555;'> 1</span>   100    <span style='text-decoration: underline;'>4</span>151.       12.8          1  5.71  2.33  7.83     0     1\n<span style='color: #555555;'> 2</span>   100    <span style='text-decoration: underline;'>8</span>067.       14.6          1  4.92  4.66  6.74     1     1\n<span style='color: #555555;'> 3</span>   100    <span style='text-decoration: underline;'>4</span>878.       12.8          1  4.88  4.21  4.68     1     1\n<span style='color: #555555;'> 4</span>   100    <span style='text-decoration: underline;'>9</span>713.       16.6          1  8.42  6.56  1.29     0     1\n<span style='color: #555555;'> 5</span>   100   <span style='text-decoration: underline;'>11</span>491.       14.4          0  4.37  3.96  3.55     0     1\n<span style='color: #555555;'> 6</span>   100    <span style='text-decoration: underline;'>2</span>452.       12.6          1  8.69  7.60  3.64     0     0\n<span style='color: #555555;'> 7</span>   100    <span style='text-decoration: underline;'>5</span>652.       14.8          1  6.61  3.95  5.13     0     0\n<span style='color: #555555;'> 8</span>   100    <span style='text-decoration: underline;'>9</span>939.       15.2          1  5.35  7.77  8.29     0     1\n<span style='color: #555555;'> 9</span>   100    <span style='text-decoration: underline;'>5</span>817.       14.6          0  5.61  2.24  9.60     0     1\n<span style='color: #555555;'>10</span>   100    <span style='text-decoration: underline;'>5</span>176.       13.7          1  6.06  1.79  8.74     0     1\n<span style='color: #555555;'># ℹ 290 more rows</span>\n</code></pre>\n:::\n\n\n\n\n\n## Fit models\n\n::: {.panel-tabset}\n\n### Sigmoidal E~max~ model\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(1234)\n\nermod_sigemax <- dev_ermod_emax(\n  data = d_sim_emax,\n  var_resp = \"response_1\",\n  var_exposure = \"exposure\",\n  gamma_fix = NULL\n)\n\nermod_sigemax\n```\n\n<pre class=\"r-output\"><code>\n<span style='color: #00BBBB;'>──</span> <span style='font-weight: bold;'>Emax model</span> <span style='color: #00BBBB;'>──────────────────────────────────────────────────────────────────</span>\n<span style='color: #00BBBB;'>ℹ</span> Use `plot_er()` to visualize ER curve\n\n── <span style='font-weight: bold;'>Developed model</span> ──\n\n---- Emax model fit with rstanemax ----\n         mean se_mean      sd   2.5%     25%     50%     75%    97.5%   n_eff\nemax    11.59    0.31    5.89   4.82    7.34   10.10   14.24    27.50  368.24\ne0       6.68    0.20    4.08  -3.67    4.78    7.68    9.71    11.48  436.14\nec50  5254.72  193.00 4475.71 801.17 2974.18 4673.97 6385.68 15736.00  537.81\ngamma    1.06    0.02    0.50   0.32    0.70    0.97    1.33     2.26  543.20\nsigma    1.27    0.00    0.05   1.18    1.24    1.27    1.31     1.39 1375.87\n      Rhat\nemax  1.01\ne0    1.01\nec50  1.00\ngamma 1.01\nsigma 1.00\n* Use `extract_stanfit()` function to extract raw stanfit object\n* Use `extract_param()` function to extract posterior draws of key parameters\n* Use `plot()` function to visualize model fit\n* Use `posterior_predict()` or `posterior_predict_quantile()` function to get\n  raw predictions or make predictions on new data\n* Use `extract_obs_mod_frame()` function to extract raw data \n  in a processed format (useful for plotting)\n</code></pre>\n:::\n\n\n\n\n\n### Regular E~max~ (γ fixed at 1)\n\nAnother model without sigmoidal component; will be used when we do\nmodel comparison.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(1234)\n\nermod_emax <- dev_ermod_emax(\n  data = d_sim_emax,\n  var_resp = \"response_1\",\n  var_exposure = \"exposure\",\n  gamma_fix = 1\n)\n\nermod_emax\n```\n\n<pre class=\"r-output\"><code>\n<span style='color: #00BBBB;'>──</span> <span style='font-weight: bold;'>Emax model</span> <span style='color: #00BBBB;'>──────────────────────────────────────────────────────────────────</span>\n<span style='color: #00BBBB;'>ℹ</span> Use `plot_er()` to visualize ER curve\n\n── <span style='font-weight: bold;'>Developed model</span> ──\n\n---- Emax model fit with rstanemax ----\n         mean se_mean      sd    2.5%     25%     50%     75%   97.5%   n_eff\nemax    10.11    0.07    1.71    7.93    8.98    9.72   10.81   14.42  564.00\ne0       7.32    0.08    2.00    2.41    6.41    7.66    8.70   10.13  572.38\nec50  4341.84   62.80 1871.39 1704.41 3062.61 3994.85 5323.78 9061.88  887.87\ngamma    1.00     NaN    0.00    1.00    1.00    1.00    1.00    1.00     NaN\nsigma    1.28    0.00    0.05    1.18    1.24    1.27    1.31    1.39 1440.04\n      Rhat\nemax  1.01\ne0    1.01\nec50  1.00\ngamma  NaN\nsigma 1.00\n* Use `extract_stanfit()` function to extract raw stanfit object\n* Use `extract_param()` function to extract posterior draws of key parameters\n* Use `plot()` function to visualize model fit\n* Use `posterior_predict()` or `posterior_predict_quantile()` function to get\n  raw predictions or make predictions on new data\n* Use `extract_obs_mod_frame()` function to extract raw data \n  in a processed format (useful for plotting)\n</code></pre>\n:::\n\n\n\n\n\n:::\n\n## Parameter summary table\n\n::: {.panel-tabset}\n\n### `posterior` package\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nd_draws_sigemax_summary <-\n  summarize_draws(ermod_sigemax)\n\nd_draws_sigemax_summary |>\n  gt() |>\n  fmt_number(decimals = 2)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<pre class=\"r-output\"><code>\n```{=html}\n<div id=\"mqnnknajtw\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#mqnnknajtw table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#mqnnknajtw thead, #mqnnknajtw tbody, #mqnnknajtw tfoot, #mqnnknajtw tr, #mqnnknajtw td, #mqnnknajtw th {\n  border-style: none;\n}\n\n#mqnnknajtw p {\n  margin: 0;\n  padding: 0;\n}\n\n#mqnnknajtw .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#mqnnknajtw .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#mqnnknajtw .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#mqnnknajtw .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#mqnnknajtw .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#mqnnknajtw .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#mqnnknajtw .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#mqnnknajtw .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#mqnnknajtw .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#mqnnknajtw .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#mqnnknajtw .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#mqnnknajtw .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#mqnnknajtw .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#mqnnknajtw .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#mqnnknajtw .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#mqnnknajtw .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#mqnnknajtw .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#mqnnknajtw .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#mqnnknajtw .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mqnnknajtw .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#mqnnknajtw .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#mqnnknajtw .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#mqnnknajtw .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mqnnknajtw .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#mqnnknajtw .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#mqnnknajtw .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#mqnnknajtw .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mqnnknajtw .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#mqnnknajtw .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#mqnnknajtw .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#mqnnknajtw .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#mqnnknajtw .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#mqnnknajtw .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mqnnknajtw .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#mqnnknajtw .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mqnnknajtw .gt_left {\n  text-align: left;\n}\n\n#mqnnknajtw .gt_center {\n  text-align: center;\n}\n\n#mqnnknajtw .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#mqnnknajtw .gt_font_normal {\n  font-weight: normal;\n}\n\n#mqnnknajtw .gt_font_bold {\n  font-weight: bold;\n}\n\n#mqnnknajtw .gt_font_italic {\n  font-style: italic;\n}\n\n#mqnnknajtw .gt_super {\n  font-size: 65%;\n}\n\n#mqnnknajtw .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#mqnnknajtw .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#mqnnknajtw .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#mqnnknajtw .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#mqnnknajtw .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#mqnnknajtw .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#mqnnknajtw .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#mqnnknajtw .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#mqnnknajtw div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"variable\">variable</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"mean\">mean</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"median\">median</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"sd\">sd</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"mad\">mad</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"q5\">q5</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"q95\">q95</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"rhat\">rhat</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"ess_bulk\">ess_bulk</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"ess_tail\">ess_tail</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">ec50</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">5,254.72</td>\n<td headers=\"median\" class=\"gt_row gt_right\">4,673.97</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">4,475.71</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">2,534.11</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">1,125.57</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">9,837.30</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.01</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">614.40</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">541.30</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">sigma</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">1.27</td>\n<td headers=\"median\" class=\"gt_row gt_right\">1.27</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">0.05</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">0.05</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">1.19</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">1.36</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">1,379.24</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">1,505.63</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">gamma</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">1.06</td>\n<td headers=\"median\" class=\"gt_row gt_right\">0.97</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">0.50</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">0.45</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">0.40</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">2.04</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.01</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">459.99</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">555.58</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">e0</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">6.68</td>\n<td headers=\"median\" class=\"gt_row gt_right\">7.68</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">4.08</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">3.42</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">−1.45</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">11.20</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.01</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">480.68</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">788.66</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">emax</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">11.59</td>\n<td headers=\"median\" class=\"gt_row gt_right\">10.10</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">5.89</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">4.79</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">5.20</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">23.06</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.01</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">429.41</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">533.51</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n</code></pre>\n`````\n:::\n:::\n\n\n\n\n\n### Highest density interval\n\nHere is the example of highest-density continuous interval (HDCI) for the median of `ED50`.\nSee [here](https://mjskay.github.io/ggdist/reference/point_interval.html) for more details.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# HDCI of median.ED50\nas_draws_df(ermod_sigemax) |>\n  tidybayes::spread_rvars(ec50) |>\n  tidybayes::median_hdci()\n```\n\n<pre class=\"r-output\"><code><span style='color: #555555;'># A tibble: 1 × 6</span>\n   ec50 .lower .upper .width .point .interval\n  <span style='color: #555555; font-style: italic;'><dbl></span>  <span style='color: #555555; font-style: italic;'><dbl></span>  <span style='color: #555555; font-style: italic;'><dbl></span>  <span style='color: #555555; font-style: italic;'><dbl></span> <span style='color: #555555; font-style: italic;'><chr></span>  <span style='color: #555555; font-style: italic;'><chr></span>    \n<span style='color: #555555;'>1</span> <span style='text-decoration: underline;'>4</span>674.   251.  <span style='text-decoration: underline;'>9</span>974.   0.95 median hdci     \n</code></pre>\n:::\n\n\n\n\n\n:::\n\n\n## Fitted values\n\nFitted values without residual errors (i.e. PRED in NONMEM term) can be\nextracted with `sim_er()` function. `.epred` is the expected value prediction.\nSee `?sim_er` for detail.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsim_er(ermod_sigemax) |> head()\n```\n\n<pre class=\"r-output\"><code><span style='color: #555555;'># A tibble: 6 × 16</span>\n<span style='color: #555555;'># Groups:   dose, exposure, response_1, response_2, cnt_a, cnt_b, cnt_c, bin_d,\n#   bin_e, .row [1]</span>\n   dose exposure response_1 response_2 cnt_a cnt_b cnt_c bin_d bin_e  .row\n  <span style='color: #555555; font-style: italic;'><dbl></span>    <span style='color: #555555; font-style: italic;'><dbl></span>      <span style='color: #555555; font-style: italic;'><dbl></span>      <span style='color: #555555; font-style: italic;'><dbl></span> <span style='color: #555555; font-style: italic;'><dbl></span> <span style='color: #555555; font-style: italic;'><dbl></span> <span style='color: #555555; font-style: italic;'><dbl></span> <span style='color: #555555; font-style: italic;'><dbl></span> <span style='color: #555555; font-style: italic;'><dbl></span> <span style='color: #555555; font-style: italic;'><int></span>\n<span style='color: #555555;'>1</span>   100    <span style='text-decoration: underline;'>4</span>151.       12.8          1  5.71  2.33  7.83     0     1     1\n<span style='color: #555555;'>2</span>   100    <span style='text-decoration: underline;'>4</span>151.       12.8          1  5.71  2.33  7.83     0     1     1\n<span style='color: #555555;'>3</span>   100    <span style='text-decoration: underline;'>4</span>151.       12.8          1  5.71  2.33  7.83     0     1     1\n<span style='color: #555555;'>4</span>   100    <span style='text-decoration: underline;'>4</span>151.       12.8          1  5.71  2.33  7.83     0     1     1\n<span style='color: #555555;'>5</span>   100    <span style='text-decoration: underline;'>4</span>151.       12.8          1  5.71  2.33  7.83     0     1     1\n<span style='color: #555555;'>6</span>   100    <span style='text-decoration: underline;'>4</span>151.       12.8          1  5.71  2.33  7.83     0     1     1\n<span style='color: #555555;'># ℹ 6 more variables: .chain <int>, .iteration <int>, .draw <int>,</span>\n<span style='color: #555555;'>#   .epred <dbl>, .linpred <dbl>, .prediction <dbl></span>\n</code></pre>\n:::\n\n\n\n\n\nYou can specify `output_type = \"median_qi\"` to get median and quantile\nintervals of the prediction.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nersim_sigemax_med_qi <-\n  sim_er(ermod_sigemax, output_type = \"median_qi\")\n\nersim_sigemax_med_qi |>\n  arrange(.row) |>\n  head() |>\n  gt(rownames_to_stub = TRUE) |>\n  fmt_number(decimals = 2, columns = -.row)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<pre class=\"r-output\"><code>\n```{=html}\n<div id=\"oslyshlwzm\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#oslyshlwzm table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#oslyshlwzm thead, #oslyshlwzm tbody, #oslyshlwzm tfoot, #oslyshlwzm tr, #oslyshlwzm td, #oslyshlwzm th {\n  border-style: none;\n}\n\n#oslyshlwzm p {\n  margin: 0;\n  padding: 0;\n}\n\n#oslyshlwzm .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#oslyshlwzm .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#oslyshlwzm .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#oslyshlwzm .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#oslyshlwzm .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#oslyshlwzm .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#oslyshlwzm .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#oslyshlwzm .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#oslyshlwzm .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#oslyshlwzm .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#oslyshlwzm .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#oslyshlwzm .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#oslyshlwzm .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#oslyshlwzm .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#oslyshlwzm .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#oslyshlwzm .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#oslyshlwzm .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#oslyshlwzm .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#oslyshlwzm .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#oslyshlwzm .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#oslyshlwzm .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#oslyshlwzm .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#oslyshlwzm .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#oslyshlwzm .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#oslyshlwzm .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#oslyshlwzm .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#oslyshlwzm .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#oslyshlwzm .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#oslyshlwzm .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#oslyshlwzm .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#oslyshlwzm .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#oslyshlwzm .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#oslyshlwzm .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#oslyshlwzm .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#oslyshlwzm .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#oslyshlwzm .gt_left {\n  text-align: left;\n}\n\n#oslyshlwzm .gt_center {\n  text-align: center;\n}\n\n#oslyshlwzm .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#oslyshlwzm .gt_font_normal {\n  font-weight: normal;\n}\n\n#oslyshlwzm .gt_font_bold {\n  font-weight: bold;\n}\n\n#oslyshlwzm .gt_font_italic {\n  font-style: italic;\n}\n\n#oslyshlwzm .gt_super {\n  font-size: 65%;\n}\n\n#oslyshlwzm .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#oslyshlwzm .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#oslyshlwzm .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#oslyshlwzm .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#oslyshlwzm .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#oslyshlwzm .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#oslyshlwzm .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#oslyshlwzm .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#oslyshlwzm div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"a::stub\"></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"dose\">dose</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"exposure\">exposure</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"response_1\">response_1</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"response_2\">response_2</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"cnt_a\">cnt_a</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"cnt_b\">cnt_b</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"cnt_c\">cnt_c</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"bin_d\">bin_d</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"bin_e\">bin_e</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"a.row\">.row</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"a.epred\">.epred</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"a.epred.lower\">.epred.lower</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"a.epred.upper\">.epred.upper</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"a.linpred\">.linpred</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"a.linpred.lower\">.linpred.lower</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"a.linpred.upper\">.linpred.upper</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"a.prediction\">.prediction</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"a.prediction.lower\">.prediction.lower</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"a.prediction.upper\">.prediction.upper</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"a.width\">.width</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"a.point\">.point</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"a.interval\">.interval</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><th id=\"stub_1_1\" scope=\"row\" class=\"gt_row gt_right gt_stub\">1</th>\n<td headers=\"stub_1_1 dose\" class=\"gt_row gt_right\">100.00</td>\n<td headers=\"stub_1_1 exposure\" class=\"gt_row gt_right\">4,151.15</td>\n<td headers=\"stub_1_1 response_1\" class=\"gt_row gt_right\">12.80</td>\n<td headers=\"stub_1_1 response_2\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"stub_1_1 cnt_a\" class=\"gt_row gt_right\">5.71</td>\n<td headers=\"stub_1_1 cnt_b\" class=\"gt_row gt_right\">2.33</td>\n<td headers=\"stub_1_1 cnt_c\" class=\"gt_row gt_right\">7.83</td>\n<td headers=\"stub_1_1 bin_d\" class=\"gt_row gt_right\">0.00</td>\n<td headers=\"stub_1_1 bin_e\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"stub_1_1 .row\" class=\"gt_row gt_right\">1</td>\n<td headers=\"stub_1_1 .epred\" class=\"gt_row gt_right\">12.62</td>\n<td headers=\"stub_1_1 .epred.lower\" class=\"gt_row gt_right\">12.33</td>\n<td headers=\"stub_1_1 .epred.upper\" class=\"gt_row gt_right\">12.92</td>\n<td headers=\"stub_1_1 .linpred\" class=\"gt_row gt_right\">12.62</td>\n<td headers=\"stub_1_1 .linpred.lower\" class=\"gt_row gt_right\">12.33</td>\n<td headers=\"stub_1_1 .linpred.upper\" class=\"gt_row gt_right\">12.92</td>\n<td headers=\"stub_1_1 .prediction\" class=\"gt_row gt_right\">12.63</td>\n<td headers=\"stub_1_1 .prediction.lower\" class=\"gt_row gt_right\">10.03</td>\n<td headers=\"stub_1_1 .prediction.upper\" class=\"gt_row gt_right\">15.29</td>\n<td headers=\"stub_1_1 .width\" class=\"gt_row gt_right\">0.95</td>\n<td headers=\"stub_1_1 .point\" class=\"gt_row gt_left\">median</td>\n<td headers=\"stub_1_1 .interval\" class=\"gt_row gt_left\">qi</td></tr>\n    <tr><th id=\"stub_1_2\" scope=\"row\" class=\"gt_row gt_right gt_stub\">2</th>\n<td headers=\"stub_1_2 dose\" class=\"gt_row gt_right\">100.00</td>\n<td headers=\"stub_1_2 exposure\" class=\"gt_row gt_right\">8,067.26</td>\n<td headers=\"stub_1_2 response_1\" class=\"gt_row gt_right\">14.58</td>\n<td headers=\"stub_1_2 response_2\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"stub_1_2 cnt_a\" class=\"gt_row gt_right\">4.92</td>\n<td headers=\"stub_1_2 cnt_b\" class=\"gt_row gt_right\">4.66</td>\n<td headers=\"stub_1_2 cnt_c\" class=\"gt_row gt_right\">6.74</td>\n<td headers=\"stub_1_2 bin_d\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"stub_1_2 bin_e\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"stub_1_2 .row\" class=\"gt_row gt_right\">2</td>\n<td headers=\"stub_1_2 .epred\" class=\"gt_row gt_right\">14.14</td>\n<td headers=\"stub_1_2 .epred.lower\" class=\"gt_row gt_right\">13.93</td>\n<td headers=\"stub_1_2 .epred.upper\" class=\"gt_row gt_right\">14.35</td>\n<td headers=\"stub_1_2 .linpred\" class=\"gt_row gt_right\">14.14</td>\n<td headers=\"stub_1_2 .linpred.lower\" class=\"gt_row gt_right\">13.93</td>\n<td headers=\"stub_1_2 .linpred.upper\" class=\"gt_row gt_right\">14.35</td>\n<td headers=\"stub_1_2 .prediction\" class=\"gt_row gt_right\">14.14</td>\n<td headers=\"stub_1_2 .prediction.lower\" class=\"gt_row gt_right\">11.69</td>\n<td headers=\"stub_1_2 .prediction.upper\" class=\"gt_row gt_right\">16.69</td>\n<td headers=\"stub_1_2 .width\" class=\"gt_row gt_right\">0.95</td>\n<td headers=\"stub_1_2 .point\" class=\"gt_row gt_left\">median</td>\n<td headers=\"stub_1_2 .interval\" class=\"gt_row gt_left\">qi</td></tr>\n    <tr><th id=\"stub_1_3\" scope=\"row\" class=\"gt_row gt_right gt_stub\">3</th>\n<td headers=\"stub_1_3 dose\" class=\"gt_row gt_right\">100.00</td>\n<td headers=\"stub_1_3 exposure\" class=\"gt_row gt_right\">4,877.67</td>\n<td headers=\"stub_1_3 response_1\" class=\"gt_row gt_right\">12.76</td>\n<td headers=\"stub_1_3 response_2\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"stub_1_3 cnt_a\" class=\"gt_row gt_right\">4.88</td>\n<td headers=\"stub_1_3 cnt_b\" class=\"gt_row gt_right\">4.21</td>\n<td headers=\"stub_1_3 cnt_c\" class=\"gt_row gt_right\">4.68</td>\n<td headers=\"stub_1_3 bin_d\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"stub_1_3 bin_e\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"stub_1_3 .row\" class=\"gt_row gt_right\">3</td>\n<td headers=\"stub_1_3 .epred\" class=\"gt_row gt_right\">13.00</td>\n<td headers=\"stub_1_3 .epred.lower\" class=\"gt_row gt_right\">12.73</td>\n<td headers=\"stub_1_3 .epred.upper\" class=\"gt_row gt_right\">13.24</td>\n<td headers=\"stub_1_3 .linpred\" class=\"gt_row gt_right\">13.00</td>\n<td headers=\"stub_1_3 .linpred.lower\" class=\"gt_row gt_right\">12.73</td>\n<td headers=\"stub_1_3 .linpred.upper\" class=\"gt_row gt_right\">13.24</td>\n<td headers=\"stub_1_3 .prediction\" class=\"gt_row gt_right\">12.98</td>\n<td headers=\"stub_1_3 .prediction.lower\" class=\"gt_row gt_right\">10.52</td>\n<td headers=\"stub_1_3 .prediction.upper\" class=\"gt_row gt_right\">15.51</td>\n<td headers=\"stub_1_3 .width\" class=\"gt_row gt_right\">0.95</td>\n<td headers=\"stub_1_3 .point\" class=\"gt_row gt_left\">median</td>\n<td headers=\"stub_1_3 .interval\" class=\"gt_row gt_left\">qi</td></tr>\n    <tr><th id=\"stub_1_4\" scope=\"row\" class=\"gt_row gt_right gt_stub\">4</th>\n<td headers=\"stub_1_4 dose\" class=\"gt_row gt_right\">100.00</td>\n<td headers=\"stub_1_4 exposure\" class=\"gt_row gt_right\">9,712.93</td>\n<td headers=\"stub_1_4 response_1\" class=\"gt_row gt_right\">16.55</td>\n<td headers=\"stub_1_4 response_2\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"stub_1_4 cnt_a\" class=\"gt_row gt_right\">8.42</td>\n<td headers=\"stub_1_4 cnt_b\" class=\"gt_row gt_right\">6.56</td>\n<td headers=\"stub_1_4 cnt_c\" class=\"gt_row gt_right\">1.29</td>\n<td headers=\"stub_1_4 bin_d\" class=\"gt_row gt_right\">0.00</td>\n<td headers=\"stub_1_4 bin_e\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"stub_1_4 .row\" class=\"gt_row gt_right\">4</td>\n<td headers=\"stub_1_4 .epred\" class=\"gt_row gt_right\">14.53</td>\n<td headers=\"stub_1_4 .epred.lower\" class=\"gt_row gt_right\">14.31</td>\n<td headers=\"stub_1_4 .epred.upper\" class=\"gt_row gt_right\">14.74</td>\n<td headers=\"stub_1_4 .linpred\" class=\"gt_row gt_right\">14.53</td>\n<td headers=\"stub_1_4 .linpred.lower\" class=\"gt_row gt_right\">14.31</td>\n<td headers=\"stub_1_4 .linpred.upper\" class=\"gt_row gt_right\">14.74</td>\n<td headers=\"stub_1_4 .prediction\" class=\"gt_row gt_right\">14.51</td>\n<td headers=\"stub_1_4 .prediction.lower\" class=\"gt_row gt_right\">12.07</td>\n<td headers=\"stub_1_4 .prediction.upper\" class=\"gt_row gt_right\">17.07</td>\n<td headers=\"stub_1_4 .width\" class=\"gt_row gt_right\">0.95</td>\n<td headers=\"stub_1_4 .point\" class=\"gt_row gt_left\">median</td>\n<td headers=\"stub_1_4 .interval\" class=\"gt_row gt_left\">qi</td></tr>\n    <tr><th id=\"stub_1_5\" scope=\"row\" class=\"gt_row gt_right gt_stub\">5</th>\n<td headers=\"stub_1_5 dose\" class=\"gt_row gt_right\">100.00</td>\n<td headers=\"stub_1_5 exposure\" class=\"gt_row gt_right\">11,490.74</td>\n<td headers=\"stub_1_5 response_1\" class=\"gt_row gt_right\">14.41</td>\n<td headers=\"stub_1_5 response_2\" class=\"gt_row gt_right\">0.00</td>\n<td headers=\"stub_1_5 cnt_a\" class=\"gt_row gt_right\">4.37</td>\n<td headers=\"stub_1_5 cnt_b\" class=\"gt_row gt_right\">3.96</td>\n<td headers=\"stub_1_5 cnt_c\" class=\"gt_row gt_right\">3.55</td>\n<td headers=\"stub_1_5 bin_d\" class=\"gt_row gt_right\">0.00</td>\n<td headers=\"stub_1_5 bin_e\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"stub_1_5 .row\" class=\"gt_row gt_right\">5</td>\n<td headers=\"stub_1_5 .epred\" class=\"gt_row gt_right\">14.86</td>\n<td headers=\"stub_1_5 .epred.lower\" class=\"gt_row gt_right\">14.64</td>\n<td headers=\"stub_1_5 .epred.upper\" class=\"gt_row gt_right\">15.08</td>\n<td headers=\"stub_1_5 .linpred\" class=\"gt_row gt_right\">14.86</td>\n<td headers=\"stub_1_5 .linpred.lower\" class=\"gt_row gt_right\">14.64</td>\n<td headers=\"stub_1_5 .linpred.upper\" class=\"gt_row gt_right\">15.08</td>\n<td headers=\"stub_1_5 .prediction\" class=\"gt_row gt_right\">14.87</td>\n<td headers=\"stub_1_5 .prediction.lower\" class=\"gt_row gt_right\">12.36</td>\n<td headers=\"stub_1_5 .prediction.upper\" class=\"gt_row gt_right\">17.37</td>\n<td headers=\"stub_1_5 .width\" class=\"gt_row gt_right\">0.95</td>\n<td headers=\"stub_1_5 .point\" class=\"gt_row gt_left\">median</td>\n<td headers=\"stub_1_5 .interval\" class=\"gt_row gt_left\">qi</td></tr>\n    <tr><th id=\"stub_1_6\" scope=\"row\" class=\"gt_row gt_right gt_stub\">6</th>\n<td headers=\"stub_1_6 dose\" class=\"gt_row gt_right\">100.00</td>\n<td headers=\"stub_1_6 exposure\" class=\"gt_row gt_right\">2,451.55</td>\n<td headers=\"stub_1_6 response_1\" class=\"gt_row gt_right\">12.60</td>\n<td headers=\"stub_1_6 response_2\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"stub_1_6 cnt_a\" class=\"gt_row gt_right\">8.69</td>\n<td headers=\"stub_1_6 cnt_b\" class=\"gt_row gt_right\">7.60</td>\n<td headers=\"stub_1_6 cnt_c\" class=\"gt_row gt_right\">3.64</td>\n<td headers=\"stub_1_6 bin_d\" class=\"gt_row gt_right\">0.00</td>\n<td headers=\"stub_1_6 bin_e\" class=\"gt_row gt_right\">0.00</td>\n<td headers=\"stub_1_6 .row\" class=\"gt_row gt_right\">6</td>\n<td headers=\"stub_1_6 .epred\" class=\"gt_row gt_right\">11.48</td>\n<td headers=\"stub_1_6 .epred.lower\" class=\"gt_row gt_right\">10.87</td>\n<td headers=\"stub_1_6 .epred.upper\" class=\"gt_row gt_right\">12.07</td>\n<td headers=\"stub_1_6 .linpred\" class=\"gt_row gt_right\">11.48</td>\n<td headers=\"stub_1_6 .linpred.lower\" class=\"gt_row gt_right\">10.87</td>\n<td headers=\"stub_1_6 .linpred.upper\" class=\"gt_row gt_right\">12.07</td>\n<td headers=\"stub_1_6 .prediction\" class=\"gt_row gt_right\">11.47</td>\n<td headers=\"stub_1_6 .prediction.lower\" class=\"gt_row gt_right\">8.86</td>\n<td headers=\"stub_1_6 .prediction.upper\" class=\"gt_row gt_right\">14.00</td>\n<td headers=\"stub_1_6 .width\" class=\"gt_row gt_right\">0.95</td>\n<td headers=\"stub_1_6 .point\" class=\"gt_row gt_left\">median</td>\n<td headers=\"stub_1_6 .interval\" class=\"gt_row gt_left\">qi</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n</code></pre>\n`````\n:::\n:::\n\n\n\n\n\n\n## Diagnostic plots\n\nWe use the [`bayesplot` package](https://mc-stan.org/bayesplot/) \n([Cheat sheet](https://rstudio.github.io/cheatsheets/bayesplot.pdf)) \nto visualize the model fit.\n\n### Convergence\n\nGood fit results in:\n\n- Parameter distributions from MCMC chains should overlap\n- Trace plots should not show any trend\n- `Rhat` close to 1 (e.g. < 1.1)\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nd_draws_sigemax <- as_draws_df(ermod_sigemax)\nmcmc_dens_overlay(d_draws_sigemax)\n```\n\n<pre class=\"r-output\"><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.\n<span style='color: #00BBBB;'>ℹ</span> Please use `linewidth` instead.\n<span style='color: #00BBBB;'>ℹ</span> The deprecated feature was likely used in the <span style='color: #0000BB;'>bayesplot</span> package.\n  Please report the issue at <span style='color: #0000BB; font-style: italic;'><https://github.com/stan-dev/bayesplot/issues/></span>.\n</code></pre>\n\n```{.r .cell-code}\nmcmc_trace(d_draws_sigemax)\nmcmc_rhat(rhat(ermod_sigemax$mod$stanfit))\n```\n\n::: {.cell-output-display}\n![](model_diagnostics_files/figure-html/fig-convergence-1.png){#fig-convergence-1 width=672}\n:::\n\n::: {.cell-output-display}\n![](model_diagnostics_files/figure-html/fig-convergence-2.png){#fig-convergence-2 width=672}\n:::\n\n::: {.cell-output-display}\n![](model_diagnostics_files/figure-html/fig-convergence-3.png){#fig-convergence-3 width=672}\n:::\n:::\n\n\n\n\n\n### Parameter estimates distribution\n\n::: {.panel-tabset}\n\n#### `mcmc_hist`\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmcmc_hist(d_draws_sigemax)\n```\n\n<pre class=\"r-output\"><code>`stat_bin()` using `bins = 30`. Pick better value `binwidth`.\n</code></pre>::: {.cell-output-display}\n![](model_diagnostics_files/figure-html/fig-mcmc_hist-1.png){#fig-mcmc_hist width=672}\n:::\n:::\n\n\n\n\n\n#### Parameter covariance\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmcmc_pairs(d_draws_sigemax,\n  off_diag_args = list(size = 0.5, alpha = 0.25))\n```\n\n::: {.cell-output-display}\n![](model_diagnostics_files/figure-html/fig-mcmc_pairs-1.png){#fig-mcmc_pairs width=672}\n:::\n:::\n\n\n\n\n\n:::\n\n### GOF plots\n\n::: {.panel-tabset}\n\n#### Obs & Pred vs predictor\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot_er(ermod_sigemax, show_orig_data = TRUE)\n```\n\n::: {.cell-output-display}\n![](model_diagnostics_files/figure-html/fig-idv_vs_pred-1.png){#fig-idv_vs_pred width=672}\n:::\n:::\n\n\n\n\n\n#### Obs vs pred\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Preparation for diagnostic plots\nersim_sigemax_med_qi <- sim_er(ermod_sigemax, output_type = \"median_qi\")\n\nersim_sigemax_med_qi |>\n  ggplot(aes(x = .epred, y = response_1)) +\n  geom_smooth(method = \"loess\", formula = y ~ x) +\n  geom_abline(linetype = 2, color = \"grey\") +\n  geom_point() +\n  geom_errorbar(\n    mapping = aes(xmin = .epred.lower, xmax = .epred.upper), \n    orientation = \"y\"\n  ) +\n  labs(\n    title = \"Observed vs Predicted\",\n    x = \"Predicted\",\n    y = \"Observed\",\n    caption = \"Symbol: median and 95% credible interval\"\n  )\n```\n\n::: {.cell-output-display}\n![](model_diagnostics_files/figure-html/fig-obs_vs_pred-1.png){#fig-obs_vs_pred width=576}\n:::\n:::\n\n\n\n\n\n#### Residuals\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nersim_sigemax_w_resid <-\n  sim_er(ermod_sigemax) |>\n  mutate(.residual = response_1 - .epred) # Add residuals for plotting\n\nersim_sigemax_w_resid_med_qi <- median_qi(ersim_sigemax_w_resid)\n\nersim_sigemax_w_resid_med_qi |>\n  ggplot(aes(x = .epred, y = .residual)) +\n  xlab(\"Predicted (linear)\") +\n  ylab(\"Residuals\") +\n  geom_smooth(method = \"loess\", formula = y ~ x) +\n  geom_point() +\n  geom_errorbar(\n    mapping = aes(ymin = .residual.lower, ymax = .residual.upper), \n    width = 0\n  ) +\n  geom_hline(aes(yintercept = 2), lty = 2, colour = \"grey70\") +\n  geom_hline(aes(yintercept = -2), lty = 2, colour = \"grey70\")\n```\n\n::: {.cell-output-display}\n![](model_diagnostics_files/figure-html/fig-residuals-1.png){#fig-residuals width=672}\n:::\n:::\n\n\n\n\n\n#### Q-Q plot of residuals\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nersim_sigemax_w_resid_med_qi |>\n  ggplot(aes(sample = .residual)) +\n  geom_qq() +\n  geom_qq_line(colour = \"steelblue\", lty = 2, alpha = 0.4) +\n  coord_equal() +\n  labs(x = \"Theoretical\", y = \"Sample\")\n```\n\n::: {.cell-output-display}\n![](model_diagnostics_files/figure-html/fig-qq-1.png){#fig-qq width=672}\n:::\n:::\n\n\n\n\n\n:::\n\n## Model comparison\n\nYou can perform model comparison based on expected log pointwise predictive density (ELPD).\nELPD is the Bayesian leave-one-out estimate (see ?`loo-glossary`).\n\nHigher ELPD is better, therefore E~max~ model with `γ` fixed to be 1 appears better.\nHowever, `elpd_diff` is tiny and smaller than `se_diff` ([see here](https://stats.stackexchange.com/questions/608881/how-to-interpret-elpd-diff-of-bayesian-loo-estimate-in-bayesian-logistic-regress)),\ntherefore we can consider the difference to be not meaningful.\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nloo_sigemax <- loo(ermod_sigemax)\nloo_emax <- loo(ermod_emax)\n\nloo_compare(list(sigemax = loo_sigemax, emax = loo_emax))\n```\n\n<pre class=\"r-output\"><code>        elpd_diff se_diff\nemax     0.0       0.0   \nsigemax -0.9       0.4   \n</code></pre>\n:::\n",
    "supporting": [
      "model_diagnostics_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}